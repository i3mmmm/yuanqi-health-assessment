<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…ƒç‚æºæµ Â· å®¢æˆ·å¥åº·è¯„ä¼°æ•°æ®ç®¡ç†ç³»ç»Ÿ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Noto+Sans+SC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary-gold: #C8A655;
            --primary-dark: #1A1A1A;
            --primary-light: #F8F6F2;
            --text-primary: #2C2C2C;
            --text-secondary: #666666;
            --border-light: #E8E8E8;
        }
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #FAFAFA 0%, #F5F5F5 100%);
            min-height: 100vh;
            color: var(--text-primary);
            padding-bottom: 40px;
        }
        .navbar {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #2C2C2C 100%);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .navbar-brand {
            font-family: 'Noto Serif SC', serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-gold);
            letter-spacing: 4px;
        }
        .navbar-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 1px;
            font-weight: 300;
            margin-top: 4px;
        }
        .navbar-actions {
            display: flex;
            gap: 12px;
        }
        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: rgba(200, 166, 85, 0.3);
            border-color: var(--primary-gold);
        }
        .nav-btn.primary {
            background: linear-gradient(135deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-color: var(--primary-gold);
            color: var(--primary-dark);
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .page-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-dark);
            letter-spacing: 6px;
            margin-bottom: 10px;
        }
        .page-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            letter-spacing: 2px;
            font-weight: 300;
            text-transform: uppercase;
        }
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-light);
            text-align: center;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(200, 166, 85, 0.15);
            border-color: var(--primary-gold);
        }
        .stat-card .stat-number {
            font-size: 48px;
            font-weight: 700;
            color: var(--primary-gold);
            font-family: 'Noto Serif SC', serif;
            margin-bottom: 8px;
        }
        .stat-card .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .stat-card.gold-border {
            border: 2px solid var(--primary-gold);
            box-shadow: 0 4px 16px rgba(200, 166, 85, 0.2);
        }
        .section-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 24px;
            color: var(--primary-dark);
            font-weight: 600;
            letter-spacing: 2px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 2px solid var(--border-light);
            padding-bottom: 15px;
        }
        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-radius: 2px;
        }
        .assessments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .assessment-card {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .assessment-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(200, 166, 85, 0.15);
            border-color: var(--primary-gold);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .customer-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .card-date {
            font-size: 12px;
            color: var(--text-secondary);
            background: #F5F5F5;
            padding: 4px 10px;
            border-radius: 10px;
        }
        .card-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }
        .card-stat {
            background: #F8F6F2;
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
        }
        .card-stat .label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }
        .card-stat .value {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-gold);
        }
        .detail-panel {
            display: none;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-light);
            overflow: hidden;
            margin-bottom: 40px;
            animation: slideDown 0.3s ease;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .detail-panel.show {
            display: block;
        }
        .detail-header {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #2C2C2C 100%);
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .detail-title {
            color: white;
            font-size: 24px;
            font-family: 'Noto Serif SC', serif;
            font-weight: 600;
            letter-spacing: 2px;
        }
        .detail-actions {
            display: flex;
            gap: 12px;
        }
        .detail-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .detail-btn:hover {
            background: rgba(200, 166, 85, 0.3);
            border-color: var(--primary-gold);
        }
        .detail-btn.primary {
            background: linear-gradient(135deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-color: var(--primary-gold);
            color: var(--primary-dark);
        }
        .detail-content {
            padding: 40px;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .info-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .info-item label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .info-item .value {
            font-size: 15px;
            color: var(--text-primary);
            font-weight: 500;
        }
        .symptoms-selection {
            background: #F8F6F2;
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
        }
        .selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-light);
        }
        .selection-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        .selection-actions {
            display: flex;
            gap: 10px;
        }
        .selection-btn {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border-light);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .selection-btn:hover {
            border-color: var(--primary-gold);
            color: var(--primary-gold);
        }
        .symptoms-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
            padding: 5px;
        }
        .symptom-item {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .symptom-item:hover {
            border-color: var(--primary-gold);
            transform: translateX(4px);
        }
        .symptom-item.selected {
            background: linear-gradient(135deg, #FFF9E6 0%, #FFF4D9 100%);
            border-color: var(--primary-gold);
            box-shadow: 0 2px 8px rgba(200, 166, 85, 0.15);
        }
        .symptom-item .symptom-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        .symptom-item .symptom-check {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-light);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .symptom-item.selected .symptom-check {
            background: var(--primary-gold);
            border-color: var(--primary-gold);
        }
        .symptom-item.selected .symptom-check::after {
            content: 'âœ“';
            color: white;
            font-size: 14px;
            font-weight: 700;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .loading-overlay.show {
            display: flex;
        }
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(200, 166, 85, 0.2);
            border-top-color: var(--primary-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .loading-text {
            color: white;
            margin-left: 20px;
            font-size: 16px;
        }
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }
        .empty-state .icon {
            font-size: 64px;
            margin-bottom: 20px;
            color: var(--border-light);
        }
        .empty-state .message {
            font-size: 18px;
            margin-bottom: 10px;
        }
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }
            .container {
                padding: 20px;
            }
            .page-title {
                font-size: 28px;
                letter-spacing: 3px;
            }
            .assessments-grid {
                grid-template-columns: 1fr;
            }
            .detail-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            .detail-actions {
                width: 100%;
            }
            .detail-btn {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div>
            <div class="navbar-brand">å…ƒç‚æºæµ</div>
            <div class="navbar-subtitle">å®¢æˆ·å¥åº·è¯„ä¼°æ•°æ®ç®¡ç†ç³»ç»Ÿ</div>
        </div>
        <div class="navbar-actions">
            <button class="nav-btn" onclick="refreshData()">åˆ·æ–°æ•°æ®</button>
            <button class="nav-btn primary" onclick="importData()">å¯¼å…¥æ•°æ®</button>
        
        
        <button class="nav-btn" onclick="exportAllToExcel()" title="å¯¼å‡ºæ‰€æœ‰è¯„ä¼°æ•°æ®ä¸ºExcel/CSVæ ¼å¼">
            ğŸ“Š å¯¼å‡ºExcel
        </button>
        <button class="nav-btn" onclick="exportAllJSON()" title="å¯¼å‡ºæ‰€æœ‰JSONæ•°æ®å¤‡ä»½">
            ğŸ’¾ æ•°æ®å¤‡ä»½
        </button>
        <button class="nav-btn" onclick="exportSymptomsDatabase()" title="å¯¼å‡ºç—‡çŠ¶æ•°æ®åº“">
            ğŸ“‹ ç—‡çŠ¶åº“
        </button>
        <button class="nav-btn" onclick="customExport()" title="è‡ªå®šä¹‰å¯¼å‡ºå­—æ®µ">
            âš™ï¸ è‡ªå®šä¹‰
        </button>
        
    </div>
    </nav>
    
    <div class="container">
        <div class="page-header">
            <div class="page-title">ç®¡ç†åå°</div>
            <div class="page-subtitle">Customer Health Assessment Management System</div>
        </div>
        
        <div class="stats-section">
            <div class="stat-card gold-border">
                <div class="stat-number" id="total-assessments">3</div>
                <div class="stat-label">æ€»è¯„ä¼°æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-symptoms-db">299</div>
                <div class="stat-label">ç—‡çŠ¶æ•°æ®åº“</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="today-assessments">0</div>
                <div class="stat-label">ä»Šæ—¥è¯„ä¼°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-symptoms-count">0</div>
                <div class="stat-label">æ€»ç—‡çŠ¶æ•°</div>
            </div>
        </div>
        
        <div class="section-title">è¯„ä¼°è®°å½•</div>
        <div class="assessments-grid" id="assessments-grid"></div>
        
        <div class="detail-panel" id="detail-panel">
            <div class="detail-header">
                <div class="detail-title" id="detail-title">å®¢æˆ·è¯¦æƒ…</div>
                <div class="detail-actions">
                    <button class="detail-btn" onclick="closeDetail()">å…³é—­</button>
                    <button class="detail-btn primary" onclick="generatePDFReport()">ç”ŸæˆPDFæŠ¥å‘Š</button>
                </div>
            </div>
            <div class="detail-content">
                <div class="section-title">å®¢æˆ·åŸºæœ¬ä¿¡æ¯</div>
                <div class="info-grid" id="customer-info"></div>
                
                <div class="section-title">è¯„ä¼°ç»Ÿè®¡</div>
                <div class="stats-section" id="assessment-stats"></div>
                
                <div class="symptoms-selection">
                    <div class="selection-header">
                        <div class="selection-title">ç—‡çŠ¶åˆ—è¡¨ (<span id="selected-symptoms-count">0</span>/<span id="total-symptoms-in-report">0</span>)</div>
                        <div class="selection-actions">
                            <button class="selection-btn" onclick="selectAllSymptoms()">å…¨é€‰</button>
                            <button class="selection-btn" onclick="deselectAllSymptoms()">å–æ¶ˆå…¨é€‰</button>
                        </div>
                    </div>
                    <div class="symptoms-list" id="symptoms-list"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loading-text">æ­£åœ¨å¤„ç†...</div>
    </div>
    
<script>  
window.addEventListener('load', function() {  
    fetch('/api/assessments')  
        .then(r => r.json())  
        .then(data => {  
            if (data.code === 200 && data.data && data.data.assessments) {  
                window.allAssessments = data.data.assessments;  
                console.log('æˆåŠŸåŠ è½½è¯„ä¼°æ•°æ®');  
            }  
        })  
        .catch(e => console.error('åŠ è½½å¤±è´¥:', e));  
});  

        // ç—‡çŠ¶æ•°æ®åº“
        const SYMPTOMS_DATABASE = [];  
        // ä» API åŠ è½½ç—‡çŠ¶æ•°æ®  
        async function loadSymptomsDatabase() {  
        try {  
        const response = await fetch('/api/symptoms');  
        const result = await response.json();  
        if (result.code === 200 && result.data && result.data.symptoms) {  
            window.SYMPTOMS_DATABASE = result.data.symptoms;  
            console.log('ç—‡çŠ¶æ•°æ®åº“å·²åŠ è½½');  
        }  
    } catch (error) {  
        console.error('åŠ è½½ç—‡çŠ¶æ•°æ®åº“å¤±è´¥:', error);  
    }  
}  
    
// é¡µé¢åŠ è½½æ—¶è°ƒç”¨  
window.addEventListener('load', function() {  
    loadSymptomsDatabase();  
    // ... å…¶ä»–ä»£ç   
});  

        // è¯„ä¼°æ•°æ®
        const ASSESSMENTS_DATA = [{"filename": "sample_assessment_data.json", "data": {"customer_info": {"name": "å¼ å¥³å£«", "age": 35, "gender": "å¥³", "assessment_date": "2026å¹´01æœˆ27æ—¥", "contact": "138****8888"}, "selected_symptoms": [{"id": 47, "name": "é¼»å­å¹²ç‡¥", "colorRegion": "red", "organ": "å¿ƒã€å°è‚ ", "causes": [{"label": "æ¯’ç´ ", "detail": "å¹²ç‡¥ç¯å¢ƒ"}, {"label": "è¥å…»", "detail": "ç»´ç”Ÿç´ ç¼ºä¹"}, {"label": "ä¹ æƒ¯", "detail": "è¿‡åº¦æ¸…æ´"}, {"label": "ä½“è´¨", "detail": "é˜´è™š"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}], "warnings": ["æ³¨æ„é¼»è…”å¥åº·"], "taboos": ["å¿Œå¹²ç‡¥", "æ³¨æ„ä¿æ¹¿"], "severity": "mild"}, {"id": 84, "name": "çœ¼ç›ç¼çƒ­", "colorRegion": "green", "organ": "è‚ã€èƒ†", "causes": [{"label": "æ¯’ç´ ", "detail": "çœ¼éƒ¨ç‚ç—‡"}, {"label": "ä¹ æƒ¯", "detail": "ç”¨çœ¼è¿‡åº¦"}, {"label": "ä½“è´¨", "detail": "è‚ç«æ—º"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "å¾®å¾ªç¯", "detail": "å±€éƒ¨å……è¡€"}], "warnings": ["æ³¨æ„çœ¼éƒ¨ç‚ç—‡"], "taboos": ["é¿å…ç”¨çœ¼è¿‡åº¦", "æ³¨æ„ä¼‘æ¯"], "severity": "mild"}, {"id": 153, "name": "å’³å—½ä¼´å‘¼å¸å›°éš¾", "colorRegion": "white", "organ": "è‚ºã€å¤§è‚ ", "causes": [{"label": "æ¯’ç´ ", "detail": "è‚ºéƒ¨ç–¾ç—…"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "ä½“è´¨", "detail": "è‚ºè™š"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}], "warnings": ["æ³¨æ„è‚ºéƒ¨ç–¾ç—…", "éœ€ç«‹å³å°±åŒ»"], "taboos": ["å¿ŒçƒŸé…’", "ç«‹å³å°±åŒ»"], "severity": "severe"}, {"id": 161, "name": "å’³å—½ä¼´ç„¦è™‘", "colorRegion": "white", "organ": "è‚ºã€å¤§è‚ ", "causes": [{"label": "æ¯’ç´ ", "detail": "è‚ºéƒ¨ç–¾ç—…"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "ä½“è´¨", "detail": "è‚ºè™š"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}], "warnings": ["æ³¨æ„è‚ºéƒ¨ç–¾ç—…"], "taboos": ["å¿ŒçƒŸé…’", "é¿å…å—å‡‰"], "severity": "moderate"}, {"id": 183, "name": "å¤§ä¾¿å¸¦è„“", "colorRegion": "black", "organ": "è‚¾ã€è†€èƒ±", "causes": [{"label": "æ¯’ç´ ", "detail": "è‚ é“æ„ŸæŸ“"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "ä½“è´¨", "detail": "è„¾èƒƒè™šå¼±"}, {"label": "ä¹ æƒ¯", "detail": "é¥®é£Ÿä¸å½“"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}], "warnings": ["æ³¨æ„è‚ é“æ„ŸæŸ“", "éœ€ç«‹å³å°±åŒ»"], "taboos": ["å¿Œæ²¹è…»å¯’å‡‰", "ç«‹å³å°±åŒ»"], "severity": "severe"}, {"id": 194, "name": "è‚›ç˜˜", "colorRegion": "black", "organ": "è‚¾ã€è†€èƒ±", "causes": [{"label": "æ¯’ç´ ", "detail": "è‚›å‘¨è„“è‚¿"}, {"label": "å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "ä½“è´¨", "detail": "æ°”è¡€ä¸¤è™š"}, {"label": "ä¹ æƒ¯", "detail": "ä¹…å"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}], "warnings": ["æ³¨æ„è‚›ç˜˜", "éœ€ç«‹å³å°±åŒ»"], "taboos": ["å¿Œè¾›è¾£åˆºæ¿€", "ç«‹å³å°±åŒ»"], "severity": "severe"}, {"id": 226, "name": "èƒƒéƒ¨ç—‰æŒ›", "colorRegion": "yellow", "organ": "è„¾ã€èƒƒ", "causes": [{"label": "æ¯’ç´ ", "detail": "èƒƒç‚"}, {"label": "ä¹ æƒ¯", "detail": "é¥®é£Ÿä¸å½“"}, {"label": "ä½“è´¨", "detail": "è„¾èƒƒè™šå¼±"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}], "warnings": ["æ³¨æ„èƒƒç‚"], "taboos": ["å¿Œè¾›è¾£", "è§„å¾‹é¥®é£Ÿ"], "severity": "mild"}, {"id": 270, "name": "ç»å‰æƒ…ç»ªæ³¢åŠ¨", "colorRegion": "blue", "organ": "å¦‡ç§‘ç³»ç»Ÿ", "causes": [{"label": "æ¯’ç´ ", "detail": "å†…åˆ†æ³Œå¤±è°ƒ"}, {"label": "ä¹ æƒ¯", "detail": "ç†¬å¤œ"}, {"label": "ä½“è´¨", "detail": "è‚éƒè„¾è™š"}, {"label": "å…ç–«åŠ›", "detail": "å…ç–«åŠ›ä½ä¸‹"}, {"label": "å¾®å¾ªç¯", "detail": "è¡€æ¶²å¾ªç¯ä¸ç•…"}, {"label": "å‹åŠ›", "detail": "æƒ…ç»ªå‹åŠ›"}], "warnings": ["æ³¨æ„å†…åˆ†æ³Œé—®é¢˜"], "taboos": ["å¿Œè¾›è¾£", "è°ƒèŠ‚æƒ…ç»ª"], "severity": "mild"}], "symptom_count": 8}}, {"filename": "first_assessment_20251213.json", "data": {"åŸºæœ¬ä¿¡æ¯": {"å§“å": "æ¸©éºŸæ¹˜", "æ£€æµ‹æ—¥æœŸ": "2025-12-13 09:27:07", "å¹´é¾„": 53, "æ€§åˆ«": "ç”·", "èº«é«˜": 158, "ä½“é‡": 50.3, "è…°å›´": 72, "è¡€ç³–": "æœªå¡«å†™", "æ”¶ç¼©å‹": "æœªå¡«å†™", "èˆ’å¼ å‹": "æœªå¡«å†™", "å¤‡æ³¨": "12æœˆ1æ—¥å¼€å§‹çœ¼ç›å‡ºç°é‡å½±ï¼Œä¼´éšå·¦è¾¹å¤´ç–¼"}, "ç—‡çŠ¶æ•°æ®": [{"åç§°": "å¤´ç–¼", "å¼ºåº¦": 19, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["å¾®å¾ªç¯", "è‚"]}, {"åç§°": "ç™½å‘", "å¼ºåº¦": 15, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è¡°è€", "è‚¾"]}, {"åç§°": "çœ¼èƒ€", "å¼ºåº¦": 14, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚", "ç¡çœ "]}, {"åç§°": "çœ¼å¹²æ¶©", "å¼ºåº¦": 13, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚è¡€", "ç”¨çœ¼è¿‡åº¦"]}, {"åç§°": "çœ¼ä»é»„", "å¼ºåº¦": 12, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚èƒ†", "æ¯’ç´ "]}, {"åç§°": "è§†åŠ›æ¨¡ç³Š", "å¼ºåº¦": 11, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾", "æ°”è¡€"]}, {"åç§°": "èŠ±çœ¼", "å¼ºåº¦": 10, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è¡°è€", "è‚¾ç²¾"]}, {"åç§°": "çœ¼é£å½±", "å¼ºåº¦": 9, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾ä¸è¶³", "è¡€ç˜€"]}, {"åç§°": "ç™½å†…éšœ", "å¼ºåº¦": 8, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è€åŒ–", "æ™¶çŠ¶ä½“é€€åŒ–"]}, {"åç§°": "è¿‘è§†", "å¼ºåº¦": 7, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["ç”¨çœ¼è¿‡åº¦", "è‚è‚¾"]}, {"åç§°": "è€³å†…æ½®æ¹¿", "å¼ºåº¦": 6, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["æ¹¿çƒ­", "è„¾è™š"]}, {"åç§°": "å£å¹²", "å¼ºåº¦": 5, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["èƒƒçƒ­", "é˜´è™š"]}, {"åç§°": "èˆŒè¾¹é”¯é½¿", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è„¾è™š", "æ¹¿æ°”"]}, {"åç§°": "å’½å¹²", "å¼ºåº¦": 3, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚ºç‡¥", "é˜´è™š"]}, {"åç§°": "èƒƒå‡‰", "å¼ºåº¦": 3, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¯’", "é˜³è™š"]}, {"åç§°": "æ‰“å—", "å¼ºåº¦": 2, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["èƒƒæ°”ä¸Šé€†", "è‚èƒƒä¸å’Œ"]}, {"åç§°": "æ˜“é¥±", "å¼ºåº¦": 2, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¼±", "æ°”è™š"]}, {"åç§°": "æ‰‹è„šå‡‰", "å¼ºåº¦": 6, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["é˜³è™š", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "æŒ‡ç”²ç«–çº¹", "å¼ºåº¦": 5, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾ä¸è¶³", "è¡€è™š"]}, {"åç§°": "åŠæœˆç—•å°‘", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["é˜³è™š", "æ°”è¡€ä¸¤è™š"]}, {"åç§°": "è„–å­ç¡¬", "å¼ºåº¦": 7, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["é¢ˆæ¤", "è¡€ç˜€"]}, {"åç§°": "è‚©é…¸", "å¼ºåº¦": 6, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["æ°”è¡€ç˜€æ»", "é£å¯’æ¹¿"]}, {"åç§°": "è…°é…¸ç—›", "å¼ºåº¦": 8, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾è™š", "åŠ³æŸ"]}, {"åç§°": "é™è„‰æ›²å¼ ", "å¼ºåº¦": 5, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è¡€ç˜€", "æ°”è™š"]}, {"åç§°": "çš®è‚¤æ˜“é’", "å¼ºåº¦": 4, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è¡€ç˜€", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "èµ·å¤œ", "å¼ºåº¦": 3, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾è™š", "è†€èƒ±æ°”åŒ–"]}, {"åç§°": "æ€§æ¬²ä½", "å¼ºåº¦": 2, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾é˜³è™š", "æ°”è¡€ä¸¤è™š"]}, {"åç§°": "è„±è‚›", "å¼ºåº¦": 1, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["ä¸­æ°”ä¸‹é™·", "è„¾è™š"]}, {"åç§°": "è®°å¿†ä¸‹é™", "å¼ºåº¦": 6, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾ç²¾ä¸è¶³", "è„‘é«“å¤±å…»"]}, {"åç§°": "åå¤´ç—›", "å¼ºåº¦": 18, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚é˜³ä¸Šäº¢", "è¡€ç˜€"]}, {"åç§°": "é¢é»„", "å¼ºåº¦": 16, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¼±", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "çœ¼ç—›", "å¼ºåº¦": 12, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚ç«", "è¡€ç˜€"]}, {"åç§°": "è¿œè§†", "å¼ºåº¦": 6, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è€åŒ–", "æ™¶çŠ¶ä½“é€€åŒ–"]}, {"åç§°": "ç»ç»", "å¼ºåº¦": 0, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["æ­£å¸¸ç”Ÿç†", "è‚¾æ°”è¡°é€€"]}], "ç—…å› åˆ†æ": {"å¾®å¾ªç¯": 19, "ä½“è´¨": 18, "æ¯’ç´ ": 18, "ä¹ æƒ¯": 12, "è¥å…»": 11, "å†…åˆ†æ³Œ": 6, "å…ç–«åŠ›": 4, "æ°”è¡€": 2}, "è„è…‘åˆ†æ": {"è‚": 16, "èƒƒ": 5, "è‚¾": 5, "è„¾": 4, "ç»¼åˆ": 5}, "ä½“è´¨åˆ†æ": {"è¡€è™š": 15, "å¯’å‡‰": 13, "æ°”è™š": 13, "é˜³è™š": 6, "é˜´è™š": 6, "è¡€ç˜€": 4, "æ°”éƒ": 1, "æ¹¿çƒ­": 1, "ç—°æ¹¿": 1}, "æ³¨æ„äº‹é¡¹": {"è¡°è€": 9, "å‰¯ä½œç”¨": 6, "è„¾": 5, "èƒƒ": 5, "è‚¾": 3, "ç¯å¢ƒ": 3, "å—å‡‰": 3, "é¿å­•è¯": 2, "ç»æœŸ": 2, "å¼‚ç‰©": 2, "è¿‡é«˜": 2, "æ›´å¹´æœŸ": 2, "æ¹¿æ°”é‡": 2, "å’³å—½": 2, "å¿ƒ": 2}, "ç¦å¿Œäº‹é¡¹": {"æ²¹è…»": 12, "é…’": 12, "ç”Ÿå†·": 11, "è‚¥è‚‰": 10, "åˆºæ¿€": 10, "è¾›è¾£": 9, "çƒŸ": 9, "å†·é¥®": 7, "ç”œé£Ÿ": 6, "è¾£æ¤’": 5, "è›‹é»„": 3, "å†…è„": 3, "å•¤é…’": 3, "ç³¯ç±³": 3}, "æƒ…ç»ªçŠ¶æ€": {"æ€’": 14, "å‹åŠ›è¿‡å¤§": 6, "æ€": 5, "æŠ‘éƒ": 5, "ç´§å¼ ": 4, "å¿ƒæƒ…ä¸å¥½": 2, "å“€": 2, "ç„¦è™‘": 2, "æ¿€åŠ¨": 2, "æ": 1, "æƒ…å¿—å¤±è°ƒ": 1, "æƒŠ": 1, "ç²¾ç¥": 1}, "å¥åº·è¶‹åŠ¿": {"å¤–ä¼¤": 7, "é—ä¼ ": 7, "é«˜è¡€å‹": 6, "å¤±çœ ": 5, "ç³–å°¿ç—…": 5, "é’å…‰çœ¼": 4, "æ„Ÿå†’": 3, "é¢ˆæ¤ç—…": 3, "è‚¿ç˜¤": 3, "ç”²äº¢": 3, "æ¶ˆåŒ–ä¸è‰¯": 3, "è¥å…»ä¸è‰¯": 3}, "ç”Ÿæ´»ä¹ æƒ¯": {"ç†¬å¤œ": 9, "ç”¨çœ¼è¿‡åº¦": 7, "è¿‡åŠ³": 6, "è¿åŠ¨è¿‡å°‘": 5, "è´ªå‡‰": 5, "è¾å°„": 3, "ä½œæ¯ä¸è§„å¾‹": 2, "é¥®æ°´è¿‡å°‘": 2, "ä¹…å": 2}, "çŸ¿ç‰©è´¨ç¼ºä¹": {"é’™": 15, "é”Œ": 14, "ç¡’": 9, "é•": 7, "é“¬": 5, "é”°": 4, "é“": 4, "ç£·": 4}, "ç»´ç”Ÿç´ ç¼ºä¹": {"A": 15, "C": 13, "E": 12, "B1": 9, "B12": 8, "B2": 7, "B7": 5, "B6": 5, "F": 5, "B3": 4, "B5": 4, "P": 4, "B1_": 3, "D_": 3, "B9": 3, "M": 3}}}, {"filename": "second_assessment_20260113.json", "data": {"åŸºæœ¬ä¿¡æ¯": {"å§“å": "æ¸©éºŸæ¹˜", "æ£€æµ‹æ—¥æœŸ": "2026-01-13 10:15:30", "å¹´é¾„": 53, "æ€§åˆ«": "ç”·", "èº«é«˜": 158, "ä½“é‡": 50.8, "è…°å›´": 71, "è¡€ç³–": "æœªå¡«å†™", "æ”¶ç¼©å‹": "æœªå¡«å†™", "èˆ’å¼ å‹": "æœªå¡«å†™", "å¤‡æ³¨": "ç»è¿‡ä¸€ä¸ªæœˆè°ƒç†ï¼Œå¤´ç—›æœ‰æ‰€ç¼“è§£ï¼Œçœ¼ç›é‡å½±å‡è½»ï¼Œä½†ä»æœ‰å¹²æ¶©æ„Ÿ"}, "ç—‡çŠ¶æ•°æ®": [{"åç§°": "å¤´ç–¼", "å¼ºåº¦": 14, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["å¾®å¾ªç¯", "è‚"]}, {"åç§°": "åå¤´ç—›", "å¼ºåº¦": 12, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚é˜³ä¸Šäº¢", "è¡€ç˜€"]}, {"åç§°": "ç™½å‘", "å¼ºåº¦": 13, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è¡°è€", "è‚¾"]}, {"åç§°": "çœ¼å¹²æ¶©", "å¼ºåº¦": 8, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚è¡€", "ç”¨çœ¼è¿‡åº¦"]}, {"åç§°": "çœ¼ä»é»„", "å¼ºåº¦": 8, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚èƒ†", "æ¯’ç´ "]}, {"åç§°": "è§†åŠ›æ¨¡ç³Š", "å¼ºåº¦": 7, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾", "æ°”è¡€"]}, {"åç§°": "çœ¼é£å½±", "å¼ºåº¦": 5, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾ä¸è¶³", "è¡€ç˜€"]}, {"åç§°": "å£å¹²", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["èƒƒçƒ­", "é˜´è™š"]}, {"åç§°": "èˆŒè¾¹é”¯é½¿", "å¼ºåº¦": 3, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è„¾è™š", "æ¹¿æ°”"]}, {"åç§°": "æ‰‹è„šå‡‰", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["é˜³è™š", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "æŒ‡ç”²ç«–çº¹", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚è‚¾ä¸è¶³", "è¡€è™š"]}, {"åç§°": "è„–å­ç¡¬", "å¼ºåº¦": 5, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["é¢ˆæ¤", "è¡€ç˜€"]}, {"åç§°": "è‚©é…¸", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["æ°”è¡€ç˜€æ»", "é£å¯’æ¹¿"]}, {"åç§°": "è…°é…¸ç—›", "å¼ºåº¦": 5, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾è™š", "åŠ³æŸ"]}, {"åç§°": "è®°å¿†ä¸‹é™", "å¼ºåº¦": 4, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾ç²¾ä¸è¶³", "è„‘é«“å¤±å…»"]}, {"åç§°": "é¢é»„", "å¼ºåº¦": 12, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¼±", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "èƒƒå‡‰", "å¼ºåº¦": 2, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¯’", "é˜³è™š"]}, {"åç§°": "æ˜“é¥±", "å¼ºåº¦": 1, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è„¾èƒƒè™šå¼±", "æ°”è™š"]}, {"åç§°": "æ‰“å—", "å¼ºåº¦": 1, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["èƒƒæ°”ä¸Šé€†", "è‚èƒƒä¸å’Œ"]}, {"åç§°": "é™è„‰æ›²å¼ ", "å¼ºåº¦": 3, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è¡€ç˜€", "æ°”è™š"]}, {"åç§°": "çš®è‚¤æ˜“é’", "å¼ºåº¦": 2, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è¡€ç˜€", "æ°”è¡€ä¸è¶³"]}, {"åç§°": "èµ·å¤œ", "å¼ºåº¦": 2, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾è™š", "è†€èƒ±æ°”åŒ–"]}, {"åç§°": "è€³å†…æ½®æ¹¿", "å¼ºåº¦": 4, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["æ¹¿çƒ­", "è„¾è™š"]}, {"åç§°": "å’½å¹²", "å¼ºåº¦": 2, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚ºç‡¥", "é˜´è™š"]}, {"åç§°": "èŠ±çœ¼", "å¼ºåº¦": 9, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è¡°è€", "è‚¾ç²¾"]}, {"åç§°": "ç™½å†…éšœ", "å¼ºåº¦": 8, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è€åŒ–", "æ™¶çŠ¶ä½“é€€åŒ–"]}, {"åç§°": "è¿‘è§†", "å¼ºåº¦": 6, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["ç”¨çœ¼è¿‡åº¦", "è‚è‚¾"]}, {"åç§°": "è¿œè§†", "å¼ºåº¦": 5, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è€åŒ–", "æ™¶çŠ¶ä½“é€€åŒ–"]}, {"åç§°": "çœ¼èƒ€", "å¼ºåº¦": 10, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚", "ç¡çœ "]}, {"åç§°": "çœ¼ç—›", "å¼ºåº¦": 8, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["è‚ç«", "è¡€ç˜€"]}, {"åç§°": "åŠæœˆç—•å°‘", "å¼ºåº¦": 3, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["é˜³è™š", "æ°”è¡€ä¸¤è™š"]}, {"åç§°": "æ€§æ¬²ä½", "å¼ºåº¦": 1, "ä½ç½®": "å·¦ä¾§", "åŸå› æ ‡ç­¾": ["è‚¾é˜³è™š", "æ°”è¡€ä¸¤è™š"]}, {"åç§°": "è„±è‚›", "å¼ºåº¦": 0, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["ä¸­æ°”ä¸‹é™·", "è„¾è™š"]}, {"åç§°": "ç»ç»", "å¼ºåº¦": 0, "ä½ç½®": "å³ä¾§", "åŸå› æ ‡ç­¾": ["æ­£å¸¸ç”Ÿç†", "è‚¾æ°”è¡°é€€"]}], "ç—…å› åˆ†æ": {"å¾®å¾ªç¯": 15, "ä½“è´¨": 16, "æ¯’ç´ ": 14, "ä¹ æƒ¯": 10, "è¥å…»": 9, "å†…åˆ†æ³Œ": 5, "å…ç–«åŠ›": 6, "æ°”è¡€": 5}, "è„è…‘åˆ†æ": {"è‚": 12, "èƒƒ": 6, "è‚¾": 5, "è„¾": 5, "ç»¼åˆ": 4}, "ä½“è´¨åˆ†æ": {"è¡€è™š": 12, "å¯’å‡‰": 10, "æ°”è™š": 11, "é˜³è™š": 4, "é˜´è™š": 5, "è¡€ç˜€": 3, "æ°”éƒ": 0, "æ¹¿çƒ­": 0, "ç—°æ¹¿": 0}, "æ³¨æ„äº‹é¡¹": {"è¡°è€": 8, "å‰¯ä½œç”¨": 5, "è„¾": 4, "èƒƒ": 4, "è‚¾": 2, "ç¯å¢ƒ": 3, "å—å‡‰": 2, "é¿å­•è¯": 1, "ç»æœŸ": 1, "å¼‚ç‰©": 1, "è¿‡é«˜": 2, "æ›´å¹´æœŸ": 2, "æ¹¿æ°”é‡": 1, "å’³å—½": 1, "å¿ƒ": 1}, "ç¦å¿Œäº‹é¡¹": {"æ²¹è…»": 10, "é…’": 10, "ç”Ÿå†·": 9, "è‚¥è‚‰": 8, "åˆºæ¿€": 8, "è¾›è¾£": 7, "çƒŸ": 7, "å†·é¥®": 5, "ç”œé£Ÿ": 4, "è¾£æ¤’": 3, "è›‹é»„": 2, "å†…è„": 2, "å•¤é…’": 2, "ç³¯ç±³": 2}, "æƒ…ç»ªçŠ¶æ€": {"æ€’": 10, "å‹åŠ›è¿‡å¤§": 5, "æ€": 4, "æŠ‘éƒ": 3, "ç´§å¼ ": 3, "å¿ƒæƒ…ä¸å¥½": 1, "å“€": 1, "ç„¦è™‘": 1, "æ¿€åŠ¨": 1, "æ": 0, "æƒ…å¿—å¤±è°ƒ": 0, "æƒŠ": 0, "ç²¾ç¥": 0}, "å¥åº·è¶‹åŠ¿": {"å¤–ä¼¤": 6, "é—ä¼ ": 7, "é«˜è¡€å‹": 5, "å¤±çœ ": 3, "ç³–å°¿ç—…": 4, "é’å…‰çœ¼": 3, "æ„Ÿå†’": 2, "é¢ˆæ¤ç—…": 2, "è‚¿ç˜¤": 2, "ç”²äº¢": 2, "æ¶ˆåŒ–ä¸è‰¯": 2, "è¥å…»ä¸è‰¯": 2}, "ç”Ÿæ´»ä¹ æƒ¯": {"ç†¬å¤œ": 7, "ç”¨çœ¼è¿‡åº¦": 6, "è¿‡åŠ³": 4, "è¿åŠ¨è¿‡å°‘": 4, "è´ªå‡‰": 4, "è¾å°„": 3, "ä½œæ¯ä¸è§„å¾‹": 1, "é¥®æ°´è¿‡å°‘": 1, "ä¹…å": 1}, "çŸ¿ç‰©è´¨ç¼ºä¹": {"é’™": 12, "é”Œ": 12, "ç¡’": 7, "é•": 5, "é“¬": 4, "é”°": 3, "é“": 3, "ç£·": 3}, "ç»´ç”Ÿç´ ç¼ºä¹": {"A": 12, "C": 11, "E": 10, "B1": 7, "B12": 6, "B2": 5, "B7": 4, "B6": 4, "F": 4, "B3": 3, "B5": 3, "P": 3, "B1_": 2, "D_": 2, "B9": 2, "M": 2}}}];
        
        let currentAssessment = null;
        let selectedSymptoms = new Set();
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ç®¡ç†åå°åˆå§‹åŒ–å®Œæˆ');
            renderAssessments();
            updateStats();
        });
        
        function updateStats() {
            let totalSymptoms = 0;
            ASSESSMENTS_DATA.forEach(item => {
                const data = item.data;
                if (data.selectedSymptoms) {
                    totalSymptoms += data.selectedSymptoms.length;
                }
            });
            document.getElementById('total-symptoms-count').textContent = totalSymptoms;
            
            const today = new Date().toISOString().split('T')[0];
            const todayCount = ASSESSMENTS_DATA.filter(item => {
                const data = item.data;
                return data.timestamp && data.timestamp.startsWith(today);
            }).length;
            document.getElementById('today-assessments').textContent = todayCount;
        }
        
        function renderAssessments() {
            const container = document.getElementById('assessments-grid');
            
            if (ASSESSMENTS_DATA.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="icon">ğŸ“‹</div>
                        <div class="message">æš‚æ— è¯„ä¼°è®°å½•</div>
                        <div class="hint">è¯·å¯¼å…¥å®¢æˆ·è¯„ä¼°æ•°æ®</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = ASSESSMENTS_DATA.map((item, index) => {
                const data = item.data;
                const customerInfo = data.customerInfo || {};
                const selectedSymptoms = data.selectedSymptoms || [];
                const assessmentResults = data.assessmentResults || {};
                
                const name = customerInfo.name || 'æœªçŸ¥';
                const date = data.timestamp ? new Date(data.timestamp).toLocaleDateString('zh-CN') : 'æœªçŸ¥';
                const symptomCount = selectedSymptoms.length;
                const mildCount = assessmentResults.summary ? assessmentResults.summary.mild : 0;
                const moderateCount = assessmentResults.summary ? assessmentResults.summary.moderate : 0;
                const severeCount = assessmentResults.summary ? assessmentResults.summary.severe : 0;
                
                return `
                    <div class="assessment-card" onclick="showDetail(${index})">
                        <div class="card-header">
                            <div class="customer-name">${name}</div>
                            <div class="card-date">${date}</div>
                        </div>
                        <div style="font-size: 12px; color: #999; margin-bottom: 15px;">
                            æ–‡ä»¶å: ${item.filename}
                        </div>
                        <div class="card-stats">
                            <div class="card-stat">
                                <div class="label">ç—‡çŠ¶æ•°</div>
                                <div class="value">${symptomCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">è½»åº¦</div>
                                <div class="value">${mildCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">ä¸­åº¦</div>
                                <div class="value">${moderateCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">é‡åº¦</div>
                                <div class="value">${severeCount}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function showDetail(index) {
            const item = ASSESSMENTS_DATA[index];
            currentAssessment = item;
            selectedSymptoms = new Set();
            
            const selectedSymptomsList = item.data.selectedSymptoms || [];
            selectedSymptomsList.forEach(s => {
                selectedSymptoms.add(s.id);
            });
            
            const customerInfo = item.data.customerInfo || {};
            document.getElementById('detail-title').textContent = 
                customerInfo.name ? `${customerInfo.name} çš„å¥åº·è¯„ä¼°è¯¦æƒ…` : 'å®¢æˆ·è¯¦æƒ…';
            
            renderCustomerInfo(customerInfo);
            renderAssessmentStats(item.data);
            renderSymptomsList(item.data);
            
            document.getElementById('detail-panel').classList.add('show');
            document.getElementById('detail-panel').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        function renderCustomerInfo(customerInfo) {
            const container = document.getElementById('customer-info');
            const info = [
                { label: 'å§“å', value: customerInfo.name || 'æœªå¡«å†™' },
                { label: 'å¹´é¾„', value: customerInfo.age ? customerInfo.age + 'å²' : 'æœªå¡«å†™' },
                { label: 'æ€§åˆ«', value: customerInfo.gender || 'æœªå¡«å†™' },
                { label: 'æ‰‹æœº', value: customerInfo.mobile || 'æœªå¡«å†™' },
                { label: 'èº«é«˜', value: customerInfo.height ? customerInfo.height + 'cm' : 'æœªå¡«å†™' },
                { label: 'ä½“é‡', value: customerInfo.weight ? customerInfo.weight + 'kg' : 'æœªå¡«å†™' },
                { label: 'è…°å›´', value: customerInfo.waistline ? customerInfo.waistline + 'cm' : 'æœªå¡«å†™' },
                { label: 'è¡€ç³–', value: customerInfo.bloodSugar ? customerInfo.bloodSugar + 'mmol/L' : 'æœªå¡«å†™' },
                { label: 'æ”¶ç¼©å‹', value: customerInfo.systolic ? customerInfo.systolic + 'mmHg' : 'æœªå¡«å†™' },
                { label: 'èˆ’å¼ å‹', value: customerInfo.diastolic ? customerInfo.diastolic + 'mmHg' : 'æœªå¡«å†™' },
                { label: 'åœ°å€', value: customerInfo.address || 'æœªå¡«å†™' },
                { label: 'å¤‡æ³¨', value: customerInfo.notes || 'æ— ' },
            ];
            
            container.innerHTML = info.map(item => `
                <div class="info-item">
                    <label>${item.label}</label>
                    <div class="value">${item.value}</div>
                </div>
            `).join('');
        }
        
        function renderAssessmentStats(data) {
            const results = data.assessmentResults || {};
            const summary = results.summary || { total: 0, mild: 0, moderate: 0, severe: 0 };
            
            const container = document.getElementById('assessment-stats');
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${summary.total}</div>
                    <div class="stat-label">ç—‡çŠ¶æ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.mild}</div>
                    <div class="stat-label">è½»åº¦ç—‡çŠ¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.moderate}</div>
                    <div class="stat-label">ä¸­åº¦ç—‡çŠ¶</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.severe}</div>
                    <div class="stat-label">é‡åº¦ç—‡çŠ¶</div>
                </div>
            `;
        }
        
        function renderSymptomsList(data) {
            const selectedSymptomsList = data.selectedSymptoms || [];
            
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            document.getElementById('total-symptoms-in-report').textContent = selectedSymptomsList.length;
            
            const container = document.getElementById('symptoms-list');
            
            if (selectedSymptomsList.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="icon">ğŸ“‹</div>
                        <div class="message">æš‚æ— ç—‡çŠ¶æ•°æ®</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = selectedSymptomsList.map(symptom => {
                const isSelected = selectedSymptoms.has(symptom.id);
                return `
                    <div class="symptom-item ${isSelected ? 'selected' : ''}" 
                         onclick="toggleSymptom(${symptom.id})">
                        <div class="symptom-name">${symptom.name}</div>
                        <div class="symptom-check"></div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleSymptom(symptomId) {
            if (selectedSymptoms.has(symptomId)) {
                selectedSymptoms.delete(symptomId);
            } else {
                selectedSymptoms.add(symptomId);
            }
            
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            renderSymptomsList(currentAssessment.data);
        }
        
        function selectAllSymptoms() {
            const selectedSymptomsList = currentAssessment.data.selectedSymptoms || [];
            selectedSymptomsList.forEach(s => {
                selectedSymptoms.add(s.id);
            });
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            renderSymptomsList(currentAssessment.data);
        }
        
        function deselectAllSymptoms() {
            selectedSymptoms.clear();
            document.getElementById('selected-symptoms-count').textContent = 0;
            renderSymptomsList(currentAssessment.data);
        }
        
        function closeDetail() {
            document.getElementById('detail-panel').classList.remove('show');
            currentAssessment = null;
            selectedSymptoms.clear();
        }
        
        function generatePDFReport() {
            if (!currentAssessment) {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªå®¢æˆ·è®°å½•');
                return;
            }
            
            if (selectedSymptoms.size === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªç—‡çŠ¶');
                return;
            }
            
            showLoading('æ­£åœ¨ç”ŸæˆPDFæŠ¥å‘Š...');
            
            setTimeout(() => {
                const data = currentAssessment.data;
                const customerInfo = data.customerInfo || {};
                const assessmentResults = data.assessmentResults || {};
                
                const selectedSymptomsList = (data.selectedSymptoms || []).filter(
                    s => selectedSymptoms.has(s.id)
                );
                
                const reportHTML = generateReportHTML(customerInfo, assessmentResults, selectedSymptomsList);
                
                hideLoading();
                
                const reportWindow = window.open();
                reportWindow.document.write(reportHTML);
                reportWindow.document.close();
                
                alert('PDFæŠ¥å‘Šå·²ç”Ÿæˆï¼Œè¯·ä½¿ç”¨æµè§ˆå™¨æ‰“å°åŠŸèƒ½ï¼ˆCtrl+Pï¼‰ä¿å­˜ä¸ºPDF');
            }, 1000);
        }
        
        function generateReportHTML(customerInfo, assessmentResults, selectedSymptomsList) {
            const summary = assessmentResults.summary || {};
            const dimensions = assessmentResults.dimensions || {};
            const organs = assessmentResults.organs || {};
            const recommendations = assessmentResults.recommendations || [];
            
            return `
        <!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>å…ƒç‚æºæµ Â· å¥åº·è¯„ä¼°æŠ¥å‘Š</title>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { font-family: 'Noto Serif SC', serif; line-height: 1.8; color: #2C2C2C; margin: 0; padding: 40px; background: #FAFAFA; }
                .container { max-width: 1000px; margin: 0 auto; background: white; padding: 50px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
                .header { text-align: center; margin-bottom: 50px; border-bottom: 3px solid #C8A655; padding-bottom: 30px; }
                .header h1 { font-size: 32px; color: #C8A655; margin-bottom: 15px; letter-spacing: 6px; }
                .vip-badge { background: #C8A655; color: white; padding: 8px 24px; border-radius: 25px; font-size: 14px; display: inline-block; margin-bottom: 20px; letter-spacing: 2px; }
                .section { margin-bottom: 35px; }
                .section-title { font-size: 22px; font-weight: 700; color: #2C2C2C; margin-bottom: 20px; position: relative; padding-bottom: 10px; border-bottom: 2px solid #E8E8E8; }
                .section-title::after { content: ''; width: 60px; height: 3px; background: #C8A655; position: absolute; bottom: -2px; left: 0; }
                .info-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                .info-table th, .info-table td { padding: 12px 15px; border-bottom: 1px solid #E8E8E8; text-align: left; font-size: 14px; }
                .info-table th { background: #F8F6F2; color: #2C2C2C; font-weight: 600; width: 30%; }
                .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px 0; }
                .stat-card { background: #F8F6F2; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
                .stat-card h4 { font-size: 14px; color: #2C2C2C; margin-bottom: 10px; font-weight: 600; }
                .stat-value { font-size: 32px; font-weight: 700; color: #C8A655; }
                .recommendations { background: #E8F5E9; border-left: 4px solid #4CAF50; padding: 20px; margin: 20px 0; border-radius: 5px; }
                .recommendations h4 { margin-top: 0; color: #2E7D32; font-size: 16px; margin-bottom: 12px; }
                .recommendations ul { margin: 0; padding-left: 20px; }
                .recommendations li { margin-bottom: 6px; color: #333; font-size: 14px; }
                .footer { text-align: center; margin-top: 50px; padding-top: 30px; border-top: 1px solid #E8E8E8; color: #999; font-size: 12px; }
                @media print { body { padding: 0; background: white; } .container { box-shadow: none; padding: 30px; } }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <div class="vip-badge">VIP ä¸“å±æŠ¥å‘Š</div>
                    <h1>å…ƒç‚æºæµ</h1>
                    <h3>å¥åº·è¯„ä¼°æŠ¥å‘Š</h3>
                    <p style="color: #999; margin-top: 15px; letter-spacing: 1px; font-size: 13px;">${new Date().toLocaleString('zh-CN')}</p>
                </div>
                
                <div class="section">
                    <div class="section-title">ä¸€ã€ä¸ªäººåŸºæœ¬ä¿¡æ¯</div>
                    <table class="info-table">
                        <tr><th>å§“å</th><td>${customerInfo.name || 'æœªå¡«å†™'}</td><th>å¹´é¾„</th><td>${customerInfo.age || 'æœªå¡«å†™'} å²</td></tr>
                        <tr><th>æ€§åˆ«</th><td>${customerInfo.gender || 'æœªå¡«å†™'}</td><th>è”ç³»æ–¹å¼</th><td>${customerInfo.mobile || 'æœªå¡«å†™'}</td></tr>
                        <tr><th>èº«é«˜</th><td>${customerInfo.height ? customerInfo.height + 'cm' : 'æœªå¡«å†™'}</td><th>ä½“é‡</th><td>${customerInfo.weight ? customerInfo.weight + 'kg' : 'æœªå¡«å†™'}</td></tr>
                        <tr><th>æ”¶ç¼©å‹</th><td>${customerInfo.systolic || 'æœªå¡«å†™'} mmHg</td><th>èˆ’å¼ å‹</th><td>${customerInfo.diastolic || 'æœªå¡«å†™'} mmHg</td></tr>
                        <tr><th>è¡€ç³–</th><td>${customerInfo.bloodSugar || 'æœªå¡«å†™'} mmol/L</td><th>è…°å›´</th><td>${customerInfo.waistline ? customerInfo.waistline + 'cm' : 'æœªå¡«å†™'}</td></tr>
                        <tr><th>åœ°å€</th><td colspan="3">${customerInfo.address || 'æœªå¡«å†™'}</td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">äºŒã€ç—‡çŠ¶ç»Ÿè®¡</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4>æ€»ç—‡çŠ¶æ•°</h4>
                            <div class="stat-value">${summary.total}</div>
                        </div>
                        <div class="stat-card">
                            <h4>è½»åº¦ç—‡çŠ¶</h4>
                            <div class="stat-value">${summary.mild}</div>
                        </div>
                        <div class="stat-card">
                            <h4>ä¸­åº¦ç—‡çŠ¶</h4>
                            <div class="stat-value">${summary.moderate}</div>
                        </div>
                        <div class="stat-card">
                            <h4>é‡åº¦ç—‡çŠ¶</h4>
                            <div class="stat-value">${summary.severe}</div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">ä¸‰ã€ç»´åº¦å¾—åˆ†</div>
                    <table class="info-table">
                        <tr><th>æ¯’ç´ </th><td>${dimensions.toxins || 0}%</td><th>è¥å…»</th><td>${dimensions.nutrition || 0}%</td></tr>
                        <tr><th>å…ç–«åŠ›</th><td>${dimensions.immunity || 0}%</td><th>ä¹ æƒ¯</th><td>${dimensions.habit || 0}%</td></tr>
                        <tr><th>å†…åˆ†æ³Œ</th><td>${dimensions.endocrine || 0}%</td><th>å¾ªç¯</th><td>${dimensions.circulation || 0}%</td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">å››ã€è„è…‘å¥åº·</div>
                    <table class="info-table">
                        <tr><th>å¿ƒ</th><td>${organs.heart || 0}</td><th>è‚</th><td>${organs.liver || 0}</td></tr>
                        <tr><th>è‚º</th><td>${organs.lung || 0}</td><th>è‚¾</th><td>${organs.kidney || 0}</td></tr>
                        <tr><th>è„¾</th><td>${organs.spleen || 0}</td><th></th><td></td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">äº”ã€ä¸ªæ€§åŒ–å»ºè®®</div>
                    <div class="recommendations">
                        <h4>å¥åº·æŒ‡å¯¼</h4>
                        <ul>
                            ${recommendations.length > 0 ? recommendations.map(rec => `<li>${rec}</li>`).join('') : '<li>ä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œå®šæœŸä½“æ£€</li>'}
                        </ul>
                    </div>
                </div>
                
                <div class="footer">
                    <p>Â© 2026 å…ƒç‚æºæµ Â· VIPä¸“å±å¥åº·è¯„ä¼°ç³»ç»Ÿ</p>
                    <p style="margin-top: 8px; color: #ccc;">å¥åº·æ•°æ®ä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰ä¸é€‚è¯·åŠæ—¶å°±åŒ»</p>
                </div>
            </div>
        </body>
        </html>
            `;
        }
        
        function importData() {
            alert('è¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®é€‰æ‹©JSONæ ¼å¼çš„è¯„ä¼°æ•°æ®æ–‡ä»¶ã€‚');
        }
        
        function refreshData() {
            showLoading('æ­£åœ¨åˆ·æ–°æ•°æ®...');
            setTimeout(() => {
                hideLoading();
                alert('æ•°æ®å·²åˆ·æ–°');
            }, 500);
        }
        
        function showLoading(text) {
            document.getElementById('loading-text').textContent = text;
            document.getElementById('loading-overlay').classList.add('show');
        }
        
        function hideLoading() {
            document.getElementById('loading-overlay').classList.remove('show');
        }
    
        
        // ========== å¢å¼ºå¯¼å‡ºåŠŸèƒ½ ==========
        
        // å¯¼å‡ºæ‰€æœ‰è¯„ä¼°æ•°æ®ä¸ºExcel/CSVæ ¼å¼
        function exportAllToExcel() {
            if (window.allAssessments.length === 0) {
                alert('æš‚æ— è¯„ä¼°æ•°æ®å¯å¯¼å‡ºï¼');
                return;
            }
            
            // æ„å»ºCSVå†…å®¹
            let csvContent = 'ç¼–å·,å§“å,ç”µè¯,å¹´é¾„,æ€§åˆ«,èº«é«˜,ä½“é‡,è…°å›´,æ”¶ç¼©å‹,èˆ’å¼ å‹,è¡€ç³–,è¯„ä¼°æ—¥æœŸ,ç—‡çŠ¶æ€»æ•°,è½»åº¦,ä¸­åº¦,é‡åº¦,ç—‡çŠ¶åˆ—è¡¨\n';
            
            window.allAssessments.forEach((assessment, index) => {
                const basicInfo = assessment.åŸºæœ¬ä¿¡æ¯ || assessment;
                const symptoms = assessment.å·²é€‰æ‹©ç—‡çŠ¶ || [];
                
                // ç»Ÿè®¡ä¸¥é‡ç¨‹åº¦
                let mild = 0, moderate = 0, severe = 0;
                symptoms.forEach(s => {
                    if (typeof s === 'object' && s.ä¸¥é‡ç¨‹åº¦) {
                        if (s.ä¸¥é‡ç¨‹åº¦ === 'è½»åº¦') mild++;
                        else if (s.ä¸¥é‡ç¨‹åº¦ === 'ä¸­åº¦') moderate++;
                        else if (s.ä¸¥é‡ç¨‹åº¦ === 'é‡åº¦') severe++;
                    }
                });
                
                // ç—‡çŠ¶åˆ—è¡¨ï¼ˆç”¨åˆ†å·åˆ†éš”ï¼‰
                const symptomList = symptoms.map(s => typeof s === 'object' ? s.ç—‡çŠ¶ : s).join(';');
                
                const row = [
                    index + 1,
                    basicInfo.å§“å || 'æœªçŸ¥',
                    basicInfo.ç”µè¯ || '',
                    basicInfo.å¹´é¾„ || '',
                    basicInfo.æ€§åˆ« || '',
                    basicInfo.èº«é«˜ || '',
                    basicInfo.ä½“é‡ || '',
                    basicInfo.è…°å›´ || '',
                    basicInfo.æ”¶ç¼©å‹ || '',
                    basicInfo.èˆ’å¼ å‹ || '',
                    basicInfo.è¡€ç³– || '',
                    assessment.è¯„ä¼°æ—¥æœŸ || '',
                    symptoms.length,
                    mild,
                    moderate,
                    severe,
                    `"${symptomList}"`
                ];
                
                csvContent += row.join(',') + '\n';
            });
            
            // ä¸‹è½½CSVæ–‡ä»¶
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…ƒç‚æºæµè¯„ä¼°æ•°æ®æ±‡æ€»_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`æˆåŠŸå¯¼å‡º ${window.allAssessments.length} æ¡è¯„ä¼°æ•°æ®ä¸ºExcel/CSVæ ¼å¼ï¼`);
        }
        
        // å¯¼å‡ºæ‰€æœ‰JSONæ•°æ®ï¼ˆæ‰“åŒ…å¤‡ä»½ï¼‰
        function exportAllJSON() {
            if (window.allAssessments.length === 0) {
                alert('æš‚æ— è¯„ä¼°æ•°æ®å¯å¯¼å‡ºï¼');
                return;
            }
            
            // åˆ›å»ºå¤‡ä»½å¯¹è±¡
            const backup = {
                å¤‡ä»½æ—¶é—´: new Date().toLocaleString('zh-CN'),
                ç³»ç»Ÿåç§°: 'å…ƒç‚æºæµå¥åº·è¯„ä¼°ç³»ç»Ÿ',
                ç‰ˆæœ¬: 'v1.0',
                æ•°æ®ç»Ÿè®¡: {
                    æ€»è¯„ä¼°æ•°: window.allAssessments.length,
                    æ€»ç—‡çŠ¶æ•°: window.allAssessments.reduce((sum, a) => sum + (a.å·²é€‰æ‹©ç—‡çŠ¶?.length || 0), 0)
                },
                è¯„ä¼°æ•°æ®: window.allAssessments
            };
            
            // ä¸‹è½½JSONæ–‡ä»¶
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…ƒç‚æºæµæ•°æ®å¤‡ä»½_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`æˆåŠŸå¯¼å‡ºæ•°æ®å¤‡ä»½ï¼ŒåŒ…å« ${window.allAssessments.length} æ¡è¯„ä¼°è®°å½•ï¼`);
        }
        
        // å¤åˆ¶è¯„ä¼°è¯¦æƒ…åˆ°å‰ªè´´æ¿
        function copyAssessmentDetails(index) {
            const assessment = window.allAssessments[index];
            if (!assessment) {
                alert('è¯„ä¼°æ•°æ®ä¸å­˜åœ¨ï¼');
                return;
            }
            
            const basicInfo = assessment.åŸºæœ¬ä¿¡æ¯ || assessment;
            const symptoms = assessment.å·²é€‰æ‹©ç—‡çŠ¶ || [];
            
            const text = `
ã€å…ƒç‚æºæµå¥åº·è¯„ä¼°æŠ¥å‘Šã€‘

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åŸºæœ¬ä¿¡æ¯
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
å§“åï¼š${basicInfo.å§“å || 'æœªçŸ¥'}
ç”µè¯ï¼š${basicInfo.ç”µè¯ || 'æœªå¡«å†™'}
å¹´é¾„ï¼š${basicInfo.å¹´é¾„ || 'æœªå¡«å†™'}
æ€§åˆ«ï¼š${basicInfo.æ€§åˆ« || 'æœªå¡«å†™'}
èº«é«˜ï¼š${basicInfo.èº«é«˜ || 'æœªå¡«å†™'} cm
ä½“é‡ï¼š${basicInfo.ä½“é‡ || 'æœªå¡«å†™'} kg
è…°å›´ï¼š${basicInfo.è…°å›´ || 'æœªå¡«å†™'} cm
æ”¶ç¼©å‹ï¼š${basicInfo.æ”¶ç¼©å‹ || 'æœªå¡«å†™'} mmHg
èˆ’å¼ å‹ï¼š${basicInfo.èˆ’å¼ å‹ || 'æœªå¡«å†™'} mmHg
è¡€ç³–ï¼š${basicInfo.è¡€ç³– || 'æœªå¡«å†™'} mmol/L
è¯„ä¼°æ—¥æœŸï¼š${assessment.è¯„ä¼°æ—¥æœŸ || 'æœªçŸ¥'}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç—‡çŠ¶ç»Ÿè®¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç—‡çŠ¶æ€»æ•°ï¼š${symptoms.length} ä¸ª

ç—‡çŠ¶åˆ—è¡¨ï¼š
${symptoms.map((s, i) => `${i+1}. ${typeof s === 'object' ? s.ç—‡çŠ¶ : s} (${typeof s === 'object' ? s.ä¸¥é‡ç¨‹åº¦ || 'æœªæ ‡è®°' : 'æœªæ ‡è®°'})`).join('\n')}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
            `.trim();
            
            // å¤åˆ¶åˆ°å‰ªè´´æ¿
            navigator.clipboard.writeText(text).then(() => {
                alert('è¯„ä¼°è¯¦æƒ…å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼å¯ä»¥ç²˜è´´åˆ°å¾®ä¿¡ã€Wordç­‰åº”ç”¨ã€‚');
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶ã€‚');
            });
        }
        
        // å¯¼å‡ºç—‡çŠ¶æ•°æ®åº“ä¸ºExcelæ ¼å¼
        function exportSymptomsDatabase() {
            // è¯»å–ç—‡çŠ¶æ•°æ®åº“
            if (!window.symptomsDatabase) {
                alert('ç—‡çŠ¶æ•°æ®åº“æœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ï¼');
                return;
            }
            
            // æ„å»ºCSVå†…å®¹
            let csvContent = 'ç¼–å·,ç—‡çŠ¶åç§°,é¢œè‰²åŒºåŸŸ,è„è…‘,ä½“è´¨,æˆå› ,æ³¨æ„äº‹é¡¹\n';
            
            window.symptomsDatabase.forEach((symptom, index) => {
                const row = [
                    index + 1,
                    symptom.name || symptom.ç—‡çŠ¶ || 'æœªçŸ¥',
                    symptom.color || symptom.é¢œè‰² || 'æœªçŸ¥',
                    symptom.organ || symptom.è„è…‘ || 'æœªçŸ¥',
                    symptom.constitution || symptom.ä½“è´¨ || 'æœªçŸ¥',
                    (symptom.cause || symptom.æˆå›  || '').replace(/,/g, 'ï¼›'),
                    (symptom.note || symptom.æ³¨æ„äº‹é¡¹ || '').replace(/,/g, 'ï¼›')
                ];
                
                csvContent += row.join(',') + '\n';
            });
            
            // ä¸‹è½½CSVæ–‡ä»¶
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…ƒç‚æºæµç—‡çŠ¶æ•°æ®åº“_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`æˆåŠŸå¯¼å‡ºç—‡çŠ¶æ•°æ®åº“ï¼ˆ${window.symptomsDatabase.length}ä¸ªç—‡çŠ¶ï¼‰ä¸ºExcelæ ¼å¼ï¼`);
        }
        
        // è‡ªå®šä¹‰å¯¼å‡ºå­—æ®µ
        function customExport() {
            if (window.allAssessments.length === 0) {
                alert('æš‚æ— è¯„ä¼°æ•°æ®å¯å¯¼å‡ºï¼');
                return;
            }
            
            // åˆ›å»ºè‡ªå®šä¹‰å¯¼å‡ºå¯¹è¯æ¡†
            const fields = [
                { id: 'name', label: 'å§“å', checked: true },
                { id: 'phone', label: 'ç”µè¯', checked: false },
                { id: 'age', label: 'å¹´é¾„', checked: true },
                { id: 'gender', label: 'æ€§åˆ«', checked: true },
                { id: 'height', label: 'èº«é«˜', checked: false },
                { id: 'weight', label: 'ä½“é‡', checked: false },
                { id: 'symptoms', label: 'ç—‡çŠ¶åˆ—è¡¨', checked: true },
                { id: 'date', label: 'è¯„ä¼°æ—¥æœŸ', checked: true }
            ];
            
            let html = `
                <div id="custom-export-modal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;">
                    <div style="background:white;padding:30px;border-radius:15px;max-width:500px;width:90%;">
                        <h3 style="margin-bottom:20px;color:#C8A655;">è‡ªå®šä¹‰å¯¼å‡ºå­—æ®µ</h3>
                        <div style="margin-bottom:20px;">
                            ${fields.map(f => `
                                <label style="display:block;margin-bottom:10px;cursor:pointer;">
                                    <input type="checkbox" id="field-${f.id}" ${f.checked ? 'checked' : ''}>
                                    ${f.label}
                                </label>
                            `).join('')}
                        </div>
                        <div style="display:flex;gap:10px;">
                            <button onclick="executeCustomExport()" style="flex:1;padding:12px;background:#C8A655;color:white;border:none;border-radius:8px;cursor:pointer;">å¯¼å‡º</button>
                            <button onclick="document.getElementById('custom-export-modal').remove()" style="flex:1;padding:12px;background:#ddd;color:#333;border:none;border-radius:8px;cursor:pointer;">å–æ¶ˆ</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }
        
        // æ‰§è¡Œè‡ªå®šä¹‰å¯¼å‡º
        function executeCustomExport() {
            const modal = document.getElementById('custom-export-modal');
            
            // è·å–é€‰ä¸­çš„å­—æ®µ
            const selectedFields = [];
            const checkboxes = modal.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach((cb, index) => {
                if (cb.checked) {
                    const fieldId = cb.id.replace('field-', '');
                    const fieldLabels = {
                        'name': 'å§“å', 'phone': 'ç”µè¯', 'age': 'å¹´é¾„', 'gender': 'æ€§åˆ«',
                        'height': 'èº«é«˜', 'weight': 'ä½“é‡', 'symptoms': 'ç—‡çŠ¶åˆ—è¡¨', 'date': 'è¯„ä¼°æ—¥æœŸ'
                    };
                    selectedFields.push({ id: fieldId, label: fieldLabels[fieldId] });
                }
            });
            
            if (selectedFields.length === 0) {
                alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå­—æ®µï¼');
                return;
            }
            
            // æ„å»ºCSVå†…å®¹
            let csvContent = selectedFields.map(f => f.label).join(',') + '\n';
            
            window.allAssessments.forEach(assessment => {
                const basicInfo = assessment.åŸºæœ¬ä¿¡æ¯ || assessment;
                const symptoms = assessment.å·²é€‰æ‹©ç—‡çŠ¶ || [];
                const row = selectedFields.map(f => {
                    switch(f.id) {
                        case 'name': return basicInfo.å§“å || 'æœªçŸ¥';
                        case 'phone': return basicInfo.ç”µè¯ || '';
                        case 'age': return basicInfo.å¹´é¾„ || '';
                        case 'gender': return basicInfo.æ€§åˆ« || '';
                        case 'height': return basicInfo.èº«é«˜ || '';
                        case 'weight': return basicInfo.ä½“é‡ || '';
                        case 'symptoms': 
                            return `"${symptoms.map(s => typeof s === 'object' ? s.ç—‡çŠ¶ : s).join(';')}"`;
                        case 'date': return assessment.è¯„ä¼°æ—¥æœŸ || '';
                        default: return '';
                    }
                });
                csvContent += row.join(',') + '\n';
            });
            
            // ä¸‹è½½CSVæ–‡ä»¶
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å…ƒç‚æºæµè‡ªå®šä¹‰å¯¼å‡º_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            modal.remove();
            alert(`æˆåŠŸå¯¼å‡º ${selectedFields.length} ä¸ªå­—æ®µçš„æ•°æ®ï¼`);
        }
        
        // ========== å¢å¼ºå¯¼å‡ºåŠŸèƒ½ç»“æŸ ==========
        
</script>
</body>
</html>
