<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÖÉÁÇÅÊ∫êÊµÅ ¬∑ ÂÆ¢Êà∑ÂÅ•Â∫∑ËØÑ‰º∞Êï∞ÊçÆÁÆ°ÁêÜÁ≥ªÁªü</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Noto+Sans+SC:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary-gold: #C8A655;
            --primary-dark: #1A1A1A;
            --primary-light: #F8F6F2;
            --text-primary: #2C2C2C;
            --text-secondary: #666666;
            --border-light: #E8E8E8;
        }
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #FAFAFA 0%, #F5F5F5 100%);
            min-height: 100vh;
            color: var(--text-primary);
            padding-bottom: 40px;
        }
        .navbar {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #2C2C2C 100%);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .navbar-brand {
            font-family: 'Noto Serif SC', serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-gold);
            letter-spacing: 4px;
        }
        .navbar-subtitle {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 1px;
            font-weight: 300;
            margin-top: 4px;
        }
        .navbar-actions {
            display: flex;
            gap: 12px;
        }
        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: rgba(200, 166, 85, 0.3);
            border-color: var(--primary-gold);
        }
        .nav-btn.primary {
            background: linear-gradient(135deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-color: var(--primary-gold);
            color: var(--primary-dark);
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .page-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-dark);
            letter-spacing: 6px;
            margin-bottom: 10px;
        }
        .page-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            letter-spacing: 2px;
            font-weight: 300;
            text-transform: uppercase;
        }
        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border-light);
            text-align: center;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(200, 166, 85, 0.15);
            border-color: var(--primary-gold);
        }
        .stat-card .stat-number {
            font-size: 48px;
            font-weight: 700;
            color: var(--primary-gold);
            font-family: 'Noto Serif SC', serif;
            margin-bottom: 8px;
        }
        .stat-card .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .stat-card.gold-border {
            border: 2px solid var(--primary-gold);
            box-shadow: 0 4px 16px rgba(200, 166, 85, 0.2);
        }
        .section-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 24px;
            color: var(--primary-dark);
            font-weight: 600;
            letter-spacing: 2px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 2px solid var(--border-light);
            padding-bottom: 15px;
        }
        .section-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: linear-gradient(180deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-radius: 2px;
        }
        .assessments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .assessment-card {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .assessment-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(200, 166, 85, 0.15);
            border-color: var(--primary-gold);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        .customer-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }
        .card-date {
            font-size: 12px;
            color: var(--text-secondary);
            background: #F5F5F5;
            padding: 4px 10px;
            border-radius: 10px;
        }
        .card-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }
        .card-stat {
            background: #F8F6F2;
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
        }
        .card-stat .label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }
        .card-stat .value {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-gold);
        }
        .detail-panel {
            display: none;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-light);
            overflow: hidden;
            margin-bottom: 40px;
            animation: slideDown 0.3s ease;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .detail-panel.show {
            display: block;
        }
        .detail-header {
            background: linear-gradient(135deg, var(--primary-dark) 0%, #2C2C2C 100%);
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .detail-title {
            color: white;
            font-size: 24px;
            font-family: 'Noto Serif SC', serif;
            font-weight: 600;
            letter-spacing: 2px;
        }
        .detail-actions {
            display: flex;
            gap: 12px;
        }
        .detail-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .detail-btn:hover {
            background: rgba(200, 166, 85, 0.3);
            border-color: var(--primary-gold);
        }
        .detail-btn.primary {
            background: linear-gradient(135deg, var(--primary-gold) 0%, #D4B86A 100%);
            border-color: var(--primary-gold);
            color: var(--primary-dark);
        }
        .detail-content {
            padding: 40px;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .info-item {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .info-item label {
            font-size: 12px;
            color: var(--text-secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .info-item .value {
            font-size: 15px;
            color: var(--text-primary);
            font-weight: 500;
        }
        .symptoms-selection {
            background: #F8F6F2;
            border-radius: 10px;
            padding: 30px;
            margin-top: 30px;
        }
        .selection-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-light);
        }
        .selection-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        .selection-actions {
            display: flex;
            gap: 10px;
        }
        .selection-btn {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border-light);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .selection-btn:hover {
            border-color: var(--primary-gold);
            color: var(--primary-gold);
        }
        .symptoms-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
            padding: 5px;
        }
        .symptom-item {
            background: white;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .symptom-item:hover {
            border-color: var(--primary-gold);
            transform: translateX(4px);
        }
        .symptom-item.selected {
            background: linear-gradient(135deg, #FFF9E6 0%, #FFF4D9 100%);
            border-color: var(--primary-gold);
            box-shadow: 0 2px 8px rgba(200, 166, 85, 0.15);
        }
        .symptom-item .symptom-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        .symptom-item .symptom-check {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-light);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .symptom-item.selected .symptom-check {
            background: var(--primary-gold);
            border-color: var(--primary-gold);
        }
        .symptom-item.selected .symptom-check::after {
            content: '‚úì';
            color: white;
            font-size: 14px;
            font-weight: 700;
        }
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .loading-overlay.show {
            display: flex;
        }
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(200, 166, 85, 0.2);
            border-top-color: var(--primary-gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .loading-text {
            color: white;
            margin-left: 20px;
            font-size: 16px;
        }
        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-secondary);
        }
        .empty-state .icon {
            font-size: 64px;
            margin-bottom: 20px;
            color: var(--border-light);
        }
        .empty-state .message {
            font-size: 18px;
            margin-bottom: 10px;
        }
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 15px;
                padding: 15px 20px;
            }
            .container {
                padding: 20px;
            }
            .page-title {
                font-size: 28px;
                letter-spacing: 3px;
            }
            .assessments-grid {
                grid-template-columns: 1fr;
            }
            .detail-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            .detail-actions {
                width: 100%;
            }
            .detail-btn {
                flex: 1;
            }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div>
            <div class="navbar-brand">ÂÖÉÁÇÅÊ∫êÊµÅ</div>
            <div class="navbar-subtitle">ÂÆ¢Êà∑ÂÅ•Â∫∑ËØÑ‰º∞Êï∞ÊçÆÁÆ°ÁêÜÁ≥ªÁªü</div>
        </div>
        <div class="navbar-actions">
            <button class="nav-btn" onclick="refreshData()">Âà∑Êñ∞Êï∞ÊçÆ</button>
            <button class="nav-btn primary" onclick="importData()">ÂØºÂÖ•Êï∞ÊçÆ</button>
        
        
        <button class="nav-btn" onclick="exportAllToExcel()" title="ÂØºÂá∫ÊâÄÊúâËØÑ‰º∞Êï∞ÊçÆ‰∏∫Excel/CSVÊ†ºÂºè">
            üìä ÂØºÂá∫Excel
        </button>
        <button class="nav-btn" onclick="exportAllJSON()" title="ÂØºÂá∫ÊâÄÊúâJSONÊï∞ÊçÆÂ§á‰ªΩ">
            üíæ Êï∞ÊçÆÂ§á‰ªΩ
        </button>
        <button class="nav-btn" onclick="exportSymptomsDatabase()" title="ÂØºÂá∫ÁóáÁä∂Êï∞ÊçÆÂ∫ì">
            üìã ÁóáÁä∂Â∫ì
        </button>
        <button class="nav-btn" onclick="customExport()" title="Ëá™ÂÆö‰πâÂØºÂá∫Â≠óÊÆµ">
            ‚öôÔ∏è Ëá™ÂÆö‰πâ
        </button>
        
    </div>
    </nav>
    
    <div class="container">
        <div class="page-header">
            <div class="page-title">ÁÆ°ÁêÜÂêéÂè∞</div>
            <div class="page-subtitle">Customer Health Assessment Management System</div>
        </div>
        
        <div class="stats-section">
            <div class="stat-card gold-border">
                <div class="stat-number" id="total-assessments">3</div>
                <div class="stat-label">ÊÄªËØÑ‰º∞Êï∞</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-symptoms-db">299</div>
                <div class="stat-label">ÁóáÁä∂Êï∞ÊçÆÂ∫ì</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="today-assessments">0</div>
                <div class="stat-label">‰ªäÊó•ËØÑ‰º∞</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-symptoms-count">0</div>
                <div class="stat-label">ÊÄªÁóáÁä∂Êï∞</div>
            </div>
        </div>
        
        <div class="section-title">ËØÑ‰º∞ËÆ∞ÂΩï</div>
        <div class="assessments-grid" id="assessments-grid"></div>
        
        <div class="detail-panel" id="detail-panel">
            <div class="detail-header">
                <div class="detail-title" id="detail-title">ÂÆ¢Êà∑ËØ¶ÊÉÖ</div>
                <div class="detail-actions">
                    <button class="detail-btn" onclick="closeDetail()">ÂÖ≥Èó≠</button>
                    <button class="detail-btn primary" onclick="generatePDFReport()">ÁîüÊàêPDFÊä•Âëä</button>
                </div>
            </div>
            <div class="detail-content">
                <div class="section-title">ÂÆ¢Êà∑Âü∫Êú¨‰ø°ÊÅØ</div>
                <div class="info-grid" id="customer-info"></div>
                
                <div class="section-title">ËØÑ‰º∞ÁªüËÆ°</div>
                <div class="stats-section" id="assessment-stats"></div>
                
                <div class="symptoms-selection">
                    <div class="selection-header">
                        <div class="selection-title">ÁóáÁä∂ÂàóË°® (<span id="selected-symptoms-count">0</span>/<span id="total-symptoms-in-report">0</span>)</div>
                        <div class="selection-actions">
                            <button class="selection-btn" onclick="selectAllSymptoms()">ÂÖ®ÈÄâ</button>
                            <button class="selection-btn" onclick="deselectAllSymptoms()">ÂèñÊ∂àÂÖ®ÈÄâ</button>
                        </div>
                    </div>
                    <div class="symptoms-list" id="symptoms-list"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loading-text">Ê≠£Âú®Â§ÑÁêÜ...</div>
    </div>
    
<script>  
window.addEventListener('load', function() {  
    fetch('/api/assessments')  
        .then(r => r.json())  
        .then(data => {  
            if (data.code === 200 && data.data && data.data.assessments) {  
                window.allAssessments = data.data.assessments;  
                console.log('ÊàêÂäüÂä†ËΩΩËØÑ‰º∞Êï∞ÊçÆ');  
            }  
        })  
        .catch(e => console.error('Âä†ËΩΩÂ§±Ë¥•:', e));  
});  

        // ÁóáÁä∂Êï∞ÊçÆÂ∫ì
        const SYMPTOMS_DATABASE = [];  
        // ‰ªé API Âä†ËΩΩÁóáÁä∂Êï∞ÊçÆ  
        async function loadSymptomsDatabase() {  
        try {  
        const response = await fetch('/api/symptoms');  
        const result = await response.json();  
        if (result.code === 200 && result.data && result.data.symptoms) {  
            window.SYMPTOMS_DATABASE = result.data.symptoms;  
            console.log('ÁóáÁä∂Êï∞ÊçÆÂ∫ìÂ∑≤Âä†ËΩΩ');  
        }  
    } catch (error) {  
        console.error('Âä†ËΩΩÁóáÁä∂Êï∞ÊçÆÂ∫ìÂ§±Ë¥•:', error);  
    }  
}  
    
// È°µÈù¢Âä†ËΩΩÊó∂Ë∞ÉÁî®  
window.addEventListener('load', function() {  
    loadSymptomsDatabase();  
    // ... ÂÖ∂‰ªñ‰ª£Á†Å  
});  

        // ËØÑ‰º∞Êï∞ÊçÆ
        const ASSESSMENTS_DATA = [{"filename": "sample_assessment_data.json", "data": {"customer_info": {"name": "Âº†Â•≥Â£´", "age": 35, "gender": "Â•≥", "assessment_date": "2026Âπ¥01Êúà27Êó•", "contact": "138****8888"}, "selected_symptoms": [{"id": 47, "name": "ÈºªÂ≠êÂπ≤Áá•", "colorRegion": "red", "organ": "ÂøÉ„ÄÅÂ∞èËÇ†", "causes": [{"label": "ÊØíÁ¥†", "detail": "Âπ≤Áá•ÁéØÂ¢É"}, {"label": "Ëê•ÂÖª", "detail": "Áª¥ÁîüÁ¥†Áº∫‰πè"}, {"label": "‰π†ÊÉØ", "detail": "ËøáÂ∫¶Ê∏ÖÊ¥Å"}, {"label": "‰ΩìË¥®", "detail": "Èò¥Ëôö"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}], "warnings": ["Ê≥®ÊÑèÈºªËÖîÂÅ•Â∫∑"], "taboos": ["ÂøåÂπ≤Áá•", "Ê≥®ÊÑè‰øùÊπø"], "severity": "mild"}, {"id": 84, "name": "ÁúºÁùõÁÅºÁÉ≠", "colorRegion": "green", "organ": "ËÇù„ÄÅËÉÜ", "causes": [{"label": "ÊØíÁ¥†", "detail": "ÁúºÈÉ®ÁÇéÁóá"}, {"label": "‰π†ÊÉØ", "detail": "Áî®ÁúºËøáÂ∫¶"}, {"label": "‰ΩìË¥®", "detail": "ËÇùÁÅ´Êó∫"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Â±ÄÈÉ®ÂÖÖË°Ä"}], "warnings": ["Ê≥®ÊÑèÁúºÈÉ®ÁÇéÁóá"], "taboos": ["ÈÅøÂÖçÁî®ÁúºËøáÂ∫¶", "Ê≥®ÊÑè‰ºëÊÅØ"], "severity": "mild"}, {"id": 153, "name": "Âí≥ÂóΩ‰º¥ÂëºÂê∏Âõ∞Èöæ", "colorRegion": "white", "organ": "ËÇ∫„ÄÅÂ§ßËÇ†", "causes": [{"label": "ÊØíÁ¥†", "detail": "ËÇ∫ÈÉ®ÁñæÁóÖ"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "‰ΩìË¥®", "detail": "ËÇ∫Ëôö"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}], "warnings": ["Ê≥®ÊÑèËÇ∫ÈÉ®ÁñæÁóÖ", "ÈúÄÁ´ãÂç≥Â∞±Âåª"], "taboos": ["ÂøåÁÉüÈÖí", "Á´ãÂç≥Â∞±Âåª"], "severity": "severe"}, {"id": 161, "name": "Âí≥ÂóΩ‰º¥ÁÑ¶Ëôë", "colorRegion": "white", "organ": "ËÇ∫„ÄÅÂ§ßËÇ†", "causes": [{"label": "ÊØíÁ¥†", "detail": "ËÇ∫ÈÉ®ÁñæÁóÖ"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "‰ΩìË¥®", "detail": "ËÇ∫Ëôö"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}], "warnings": ["Ê≥®ÊÑèËÇ∫ÈÉ®ÁñæÁóÖ"], "taboos": ["ÂøåÁÉüÈÖí", "ÈÅøÂÖçÂèóÂáâ"], "severity": "moderate"}, {"id": 183, "name": "Â§ß‰æøÂ∏¶ËÑì", "colorRegion": "black", "organ": "ËÇæ„ÄÅËÜÄËÉ±", "causes": [{"label": "ÊØíÁ¥†", "detail": "ËÇ†ÈÅìÊÑüÊüì"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "‰ΩìË¥®", "detail": "ËÑæËÉÉËôöÂº±"}, {"label": "‰π†ÊÉØ", "detail": "È•ÆÈ£ü‰∏çÂΩì"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}], "warnings": ["Ê≥®ÊÑèËÇ†ÈÅìÊÑüÊüì", "ÈúÄÁ´ãÂç≥Â∞±Âåª"], "taboos": ["ÂøåÊ≤πËÖªÂØíÂáâ", "Á´ãÂç≥Â∞±Âåª"], "severity": "severe"}, {"id": 194, "name": "ËÇõÁòò", "colorRegion": "black", "organ": "ËÇæ„ÄÅËÜÄËÉ±", "causes": [{"label": "ÊØíÁ¥†", "detail": "ËÇõÂë®ËÑìËÇø"}, {"label": "Âæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "‰ΩìË¥®", "detail": "Ê∞îË°Ä‰∏§Ëôö"}, {"label": "‰π†ÊÉØ", "detail": "‰πÖÂùê"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}], "warnings": ["Ê≥®ÊÑèËÇõÁòò", "ÈúÄÁ´ãÂç≥Â∞±Âåª"], "taboos": ["ÂøåËæõËæ£Âà∫ÊøÄ", "Á´ãÂç≥Â∞±Âåª"], "severity": "severe"}, {"id": 226, "name": "ËÉÉÈÉ®ÁóâÊåõ", "colorRegion": "yellow", "organ": "ËÑæ„ÄÅËÉÉ", "causes": [{"label": "ÊØíÁ¥†", "detail": "ËÉÉÁÇé"}, {"label": "‰π†ÊÉØ", "detail": "È•ÆÈ£ü‰∏çÂΩì"}, {"label": "‰ΩìË¥®", "detail": "ËÑæËÉÉËôöÂº±"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}], "warnings": ["Ê≥®ÊÑèËÉÉÁÇé"], "taboos": ["ÂøåËæõËæ£", "ËßÑÂæãÈ•ÆÈ£ü"], "severity": "mild"}, {"id": 270, "name": "ÁªèÂâçÊÉÖÁª™Ê≥¢Âä®", "colorRegion": "blue", "organ": "Â¶áÁßëÁ≥ªÁªü", "causes": [{"label": "ÊØíÁ¥†", "detail": "ÂÜÖÂàÜÊ≥åÂ§±Ë∞É"}, {"label": "‰π†ÊÉØ", "detail": "ÁÜ¨Â§ú"}, {"label": "‰ΩìË¥®", "detail": "ËÇùÈÉÅËÑæËôö"}, {"label": "ÂÖçÁñ´Âäõ", "detail": "ÂÖçÁñ´Âäõ‰Ωé‰∏ã"}, {"label": "ÂæÆÂæ™ÁéØ", "detail": "Ë°ÄÊ∂≤Âæ™ÁéØ‰∏çÁïÖ"}, {"label": "ÂéãÂäõ", "detail": "ÊÉÖÁª™ÂéãÂäõ"}], "warnings": ["Ê≥®ÊÑèÂÜÖÂàÜÊ≥åÈóÆÈ¢ò"], "taboos": ["ÂøåËæõËæ£", "Ë∞ÉËäÇÊÉÖÁª™"], "severity": "mild"}], "symptom_count": 8}}, {"filename": "first_assessment_20251213.json", "data": {"Âü∫Êú¨‰ø°ÊÅØ": {"ÂßìÂêç": "Ê∏©È∫üÊπò", "Ê£ÄÊµãÊó•Êúü": "2025-12-13 09:27:07", "Âπ¥ÈæÑ": 53, "ÊÄßÂà´": "Áî∑", "Ë∫´È´ò": 158, "‰ΩìÈáç": 50.3, "ËÖ∞Âõ¥": 72, "Ë°ÄÁ≥ñ": "Êú™Â°´ÂÜô", "Êî∂Áº©Âéã": "Êú™Â°´ÂÜô", "ËàíÂº†Âéã": "Êú™Â°´ÂÜô", "Â§áÊ≥®": "12Êúà1Êó•ÂºÄÂßãÁúºÁùõÂá∫Áé∞ÈáçÂΩ±Ôºå‰º¥ÈöèÂ∑¶ËæπÂ§¥Áñº"}, "ÁóáÁä∂Êï∞ÊçÆ": [{"ÂêçÁß∞": "Â§¥Áñº", "Âº∫Â∫¶": 19, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ÂæÆÂæ™ÁéØ", "ËÇù"]}, {"ÂêçÁß∞": "ÁôΩÂèë", "Âº∫Â∫¶": 15, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°∞ËÄÅ", "ËÇæ"]}, {"ÂêçÁß∞": "ÁúºËÉÄ", "Âº∫Â∫¶": 14, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇù", "Áù°Áú†"]}, {"ÂêçÁß∞": "ÁúºÂπ≤Ê∂©", "Âº∫Â∫¶": 13, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùË°Ä", "Áî®ÁúºËøáÂ∫¶"]}, {"ÂêçÁß∞": "Áúº‰ªÅÈªÑ", "Âº∫Â∫¶": 12, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÉÜ", "ÊØíÁ¥†"]}, {"ÂêçÁß∞": "ËßÜÂäõÊ®°Á≥ä", "Âº∫Â∫¶": 11, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ", "Ê∞îË°Ä"]}, {"ÂêçÁß∞": "Ëä±Áúº", "Âº∫Â∫¶": 10, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°∞ËÄÅ", "ËÇæÁ≤æ"]}, {"ÂêçÁß∞": "ÁúºÈ£ûÂΩ±", "Âº∫Â∫¶": 9, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ‰∏çË∂≥", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ÁôΩÂÜÖÈöú", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÄÅÂåñ", "Êô∂Áä∂‰ΩìÈÄÄÂåñ"]}, {"ÂêçÁß∞": "ËøëËßÜ", "Âº∫Â∫¶": 7, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Áî®ÁúºËøáÂ∫¶", "ËÇùËÇæ"]}, {"ÂêçÁß∞": "ËÄ≥ÂÜÖÊΩÆÊπø", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ÊπøÁÉ≠", "ËÑæËôö"]}, {"ÂêçÁß∞": "Âè£Âπ≤", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÉÉÁÉ≠", "Èò¥Ëôö"]}, {"ÂêçÁß∞": "ËàåËæπÈîØÈΩø", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËôö", "ÊπøÊ∞î"]}, {"ÂêçÁß∞": "ÂíΩÂπ≤", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇ∫Áá•", "Èò¥Ëôö"]}, {"ÂêçÁß∞": "ËÉÉÂáâ", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂØí", "Èò≥Ëôö"]}, {"ÂêçÁß∞": "ÊâìÂóù", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÉÉÊ∞î‰∏äÈÄÜ", "ËÇùËÉÉ‰∏çÂíå"]}, {"ÂêçÁß∞": "ÊòìÈ•±", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂº±", "Ê∞îËôö"]}, {"ÂêçÁß∞": "ÊâãËÑöÂáâ", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Èò≥Ëôö", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "ÊåáÁî≤Á´ñÁ∫π", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ‰∏çË∂≥", "Ë°ÄËôö"]}, {"ÂêçÁß∞": "ÂçäÊúàÁóïÂ∞ë", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Èò≥Ëôö", "Ê∞îË°Ä‰∏§Ëôö"]}, {"ÂêçÁß∞": "ËÑñÂ≠êÁ°¨", "Âº∫Â∫¶": 7, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["È¢àÊ§é", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ËÇ©ÈÖ∏", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ê∞îË°ÄÁòÄÊªû", "È£éÂØíÊπø"]}, {"ÂêçÁß∞": "ËÖ∞ÈÖ∏Áóõ", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæËôö", "Âä≥Êçü"]}, {"ÂêçÁß∞": "ÈùôËÑâÊõ≤Âº†", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°ÄÁòÄ", "Ê∞îËôö"]}, {"ÂêçÁß∞": "ÁöÆËÇ§ÊòìÈùí", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°ÄÁòÄ", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "Ëµ∑Â§ú", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæËôö", "ËÜÄËÉ±Ê∞îÂåñ"]}, {"ÂêçÁß∞": "ÊÄßÊ¨≤‰Ωé", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæÈò≥Ëôö", "Ê∞îË°Ä‰∏§Ëôö"]}, {"ÂêçÁß∞": "ËÑ±ËÇõ", "Âº∫Â∫¶": 1, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["‰∏≠Ê∞î‰∏ãÈô∑", "ËÑæËôö"]}, {"ÂêçÁß∞": "ËÆ∞ÂøÜ‰∏ãÈôç", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæÁ≤æ‰∏çË∂≥", "ËÑëÈ´ìÂ§±ÂÖª"]}, {"ÂêçÁß∞": "ÂÅèÂ§¥Áóõ", "Âº∫Â∫¶": 18, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùÈò≥‰∏ä‰∫¢", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "Èù¢ÈªÑ", "Âº∫Â∫¶": 16, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂº±", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "ÁúºÁóõ", "Âº∫Â∫¶": 12, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùÁÅ´", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ËøúËßÜ", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÄÅÂåñ", "Êô∂Áä∂‰ΩìÈÄÄÂåñ"]}, {"ÂêçÁß∞": "ÁªùÁªè", "Âº∫Â∫¶": 0, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ê≠£Â∏∏ÁîüÁêÜ", "ËÇæÊ∞îË°∞ÈÄÄ"]}], "ÁóÖÂõ†ÂàÜÊûê": {"ÂæÆÂæ™ÁéØ": 19, "‰ΩìË¥®": 18, "ÊØíÁ¥†": 18, "‰π†ÊÉØ": 12, "Ëê•ÂÖª": 11, "ÂÜÖÂàÜÊ≥å": 6, "ÂÖçÁñ´Âäõ": 4, "Ê∞îË°Ä": 2}, "ËÑèËÖëÂàÜÊûê": {"ËÇù": 16, "ËÉÉ": 5, "ËÇæ": 5, "ËÑæ": 4, "ÁªºÂêà": 5}, "‰ΩìË¥®ÂàÜÊûê": {"Ë°ÄËôö": 15, "ÂØíÂáâ": 13, "Ê∞îËôö": 13, "Èò≥Ëôö": 6, "Èò¥Ëôö": 6, "Ë°ÄÁòÄ": 4, "Ê∞îÈÉÅ": 1, "ÊπøÁÉ≠": 1, "Áó∞Êπø": 1}, "Ê≥®ÊÑè‰∫ãÈ°π": {"Ë°∞ËÄÅ": 9, "ÂâØ‰ΩúÁî®": 6, "ËÑæ": 5, "ËÉÉ": 5, "ËÇæ": 3, "ÁéØÂ¢É": 3, "ÂèóÂáâ": 3, "ÈÅøÂ≠ïËçØ": 2, "ÁªèÊúü": 2, "ÂºÇÁâ©": 2, "ËøáÈ´ò": 2, "Êõ¥Âπ¥Êúü": 2, "ÊπøÊ∞îÈáç": 2, "Âí≥ÂóΩ": 2, "ÂøÉ": 2}, "Á¶ÅÂøå‰∫ãÈ°π": {"Ê≤πËÖª": 12, "ÈÖí": 12, "ÁîüÂÜ∑": 11, "ËÇ•ËÇâ": 10, "Âà∫ÊøÄ": 10, "ËæõËæ£": 9, "ÁÉü": 9, "ÂÜ∑È•Æ": 7, "ÁîúÈ£ü": 6, "Ëæ£Ê§í": 5, "ËõãÈªÑ": 3, "ÂÜÖËÑè": 3, "Âï§ÈÖí": 3, "Á≥ØÁ±≥": 3}, "ÊÉÖÁª™Áä∂ÊÄÅ": {"ÊÄí": 14, "ÂéãÂäõËøáÂ§ß": 6, "ÊÄù": 5, "ÊäëÈÉÅ": 5, "Á¥ßÂº†": 4, "ÂøÉÊÉÖ‰∏çÂ•Ω": 2, "ÂìÄ": 2, "ÁÑ¶Ëôë": 2, "ÊøÄÂä®": 2, "ÊÅê": 1, "ÊÉÖÂøóÂ§±Ë∞É": 1, "ÊÉä": 1, "Á≤æÁ•û": 1}, "ÂÅ•Â∫∑Ë∂ãÂäø": {"Â§ñ‰º§": 7, "ÈÅó‰º†": 7, "È´òË°ÄÂéã": 6, "Â§±Áú†": 5, "Á≥ñÂ∞øÁóÖ": 5, "ÈùíÂÖâÁúº": 4, "ÊÑüÂÜí": 3, "È¢àÊ§éÁóÖ": 3, "ËÇøÁò§": 3, "Áî≤‰∫¢": 3, "Ê∂àÂåñ‰∏çËâØ": 3, "Ëê•ÂÖª‰∏çËâØ": 3}, "ÁîüÊ¥ª‰π†ÊÉØ": {"ÁÜ¨Â§ú": 9, "Áî®ÁúºËøáÂ∫¶": 7, "ËøáÂä≥": 6, "ËøêÂä®ËøáÂ∞ë": 5, "Ë¥™Âáâ": 5, "ËæêÂ∞Ñ": 3, "‰ΩúÊÅØ‰∏çËßÑÂæã": 2, "È•ÆÊ∞¥ËøáÂ∞ë": 2, "‰πÖÂùê": 2}, "ÁüøÁâ©Ë¥®Áº∫‰πè": {"Èíô": 15, "Èîå": 14, "Á°í": 9, "ÈïÅ": 7, "Èì¨": 5, "Èî∞": 4, "ÈìÅ": 4, "Á£∑": 4}, "Áª¥ÁîüÁ¥†Áº∫‰πè": {"A": 15, "C": 13, "E": 12, "B1": 9, "B12": 8, "B2": 7, "B7": 5, "B6": 5, "F": 5, "B3": 4, "B5": 4, "P": 4, "B1_": 3, "D_": 3, "B9": 3, "M": 3}}}, {"filename": "second_assessment_20260113.json", "data": {"Âü∫Êú¨‰ø°ÊÅØ": {"ÂßìÂêç": "Ê∏©È∫üÊπò", "Ê£ÄÊµãÊó•Êúü": "2026-01-13 10:15:30", "Âπ¥ÈæÑ": 53, "ÊÄßÂà´": "Áî∑", "Ë∫´È´ò": 158, "‰ΩìÈáç": 50.8, "ËÖ∞Âõ¥": 71, "Ë°ÄÁ≥ñ": "Êú™Â°´ÂÜô", "Êî∂Áº©Âéã": "Êú™Â°´ÂÜô", "ËàíÂº†Âéã": "Êú™Â°´ÂÜô", "Â§áÊ≥®": "ÁªèËøá‰∏Ä‰∏™ÊúàË∞ÉÁêÜÔºåÂ§¥ÁóõÊúâÊâÄÁºìËß£ÔºåÁúºÁùõÈáçÂΩ±ÂáèËΩªÔºå‰ΩÜ‰ªçÊúâÂπ≤Ê∂©ÊÑü"}, "ÁóáÁä∂Êï∞ÊçÆ": [{"ÂêçÁß∞": "Â§¥Áñº", "Âº∫Â∫¶": 14, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ÂæÆÂæ™ÁéØ", "ËÇù"]}, {"ÂêçÁß∞": "ÂÅèÂ§¥Áóõ", "Âº∫Â∫¶": 12, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùÈò≥‰∏ä‰∫¢", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ÁôΩÂèë", "Âº∫Â∫¶": 13, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°∞ËÄÅ", "ËÇæ"]}, {"ÂêçÁß∞": "ÁúºÂπ≤Ê∂©", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùË°Ä", "Áî®ÁúºËøáÂ∫¶"]}, {"ÂêçÁß∞": "Áúº‰ªÅÈªÑ", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÉÜ", "ÊØíÁ¥†"]}, {"ÂêçÁß∞": "ËßÜÂäõÊ®°Á≥ä", "Âº∫Â∫¶": 7, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ", "Ê∞îË°Ä"]}, {"ÂêçÁß∞": "ÁúºÈ£ûÂΩ±", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ‰∏çË∂≥", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "Âè£Âπ≤", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÉÉÁÉ≠", "Èò¥Ëôö"]}, {"ÂêçÁß∞": "ËàåËæπÈîØÈΩø", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËôö", "ÊπøÊ∞î"]}, {"ÂêçÁß∞": "ÊâãËÑöÂáâ", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Èò≥Ëôö", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "ÊåáÁî≤Á´ñÁ∫π", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùËÇæ‰∏çË∂≥", "Ë°ÄËôö"]}, {"ÂêçÁß∞": "ËÑñÂ≠êÁ°¨", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["È¢àÊ§é", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ËÇ©ÈÖ∏", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ê∞îË°ÄÁòÄÊªû", "È£éÂØíÊπø"]}, {"ÂêçÁß∞": "ËÖ∞ÈÖ∏Áóõ", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæËôö", "Âä≥Êçü"]}, {"ÂêçÁß∞": "ËÆ∞ÂøÜ‰∏ãÈôç", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæÁ≤æ‰∏çË∂≥", "ËÑëÈ´ìÂ§±ÂÖª"]}, {"ÂêçÁß∞": "Èù¢ÈªÑ", "Âº∫Â∫¶": 12, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂº±", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "ËÉÉÂáâ", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂØí", "Èò≥Ëôö"]}, {"ÂêçÁß∞": "ÊòìÈ•±", "Âº∫Â∫¶": 1, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÑæËÉÉËôöÂº±", "Ê∞îËôö"]}, {"ÂêçÁß∞": "ÊâìÂóù", "Âº∫Â∫¶": 1, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÉÉÊ∞î‰∏äÈÄÜ", "ËÇùËÉÉ‰∏çÂíå"]}, {"ÂêçÁß∞": "ÈùôËÑâÊõ≤Âº†", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°ÄÁòÄ", "Ê∞îËôö"]}, {"ÂêçÁß∞": "ÁöÆËÇ§ÊòìÈùí", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°ÄÁòÄ", "Ê∞îË°Ä‰∏çË∂≥"]}, {"ÂêçÁß∞": "Ëµ∑Â§ú", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæËôö", "ËÜÄËÉ±Ê∞îÂåñ"]}, {"ÂêçÁß∞": "ËÄ≥ÂÜÖÊΩÆÊπø", "Âº∫Â∫¶": 4, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ÊπøÁÉ≠", "ËÑæËôö"]}, {"ÂêçÁß∞": "ÂíΩÂπ≤", "Âº∫Â∫¶": 2, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇ∫Áá•", "Èò¥Ëôö"]}, {"ÂêçÁß∞": "Ëä±Áúº", "Âº∫Â∫¶": 9, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ë°∞ËÄÅ", "ËÇæÁ≤æ"]}, {"ÂêçÁß∞": "ÁôΩÂÜÖÈöú", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÄÅÂåñ", "Êô∂Áä∂‰ΩìÈÄÄÂåñ"]}, {"ÂêçÁß∞": "ËøëËßÜ", "Âº∫Â∫¶": 6, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Áî®ÁúºËøáÂ∫¶", "ËÇùËÇæ"]}, {"ÂêçÁß∞": "ËøúËßÜ", "Âº∫Â∫¶": 5, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÄÅÂåñ", "Êô∂Áä∂‰ΩìÈÄÄÂåñ"]}, {"ÂêçÁß∞": "ÁúºËÉÄ", "Âº∫Â∫¶": 10, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇù", "Áù°Áú†"]}, {"ÂêçÁß∞": "ÁúºÁóõ", "Âº∫Â∫¶": 8, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇùÁÅ´", "Ë°ÄÁòÄ"]}, {"ÂêçÁß∞": "ÂçäÊúàÁóïÂ∞ë", "Âº∫Â∫¶": 3, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Èò≥Ëôö", "Ê∞îË°Ä‰∏§Ëôö"]}, {"ÂêçÁß∞": "ÊÄßÊ¨≤‰Ωé", "Âº∫Â∫¶": 1, "‰ΩçÁΩÆ": "Â∑¶‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["ËÇæÈò≥Ëôö", "Ê∞îË°Ä‰∏§Ëôö"]}, {"ÂêçÁß∞": "ËÑ±ËÇõ", "Âº∫Â∫¶": 0, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["‰∏≠Ê∞î‰∏ãÈô∑", "ËÑæËôö"]}, {"ÂêçÁß∞": "ÁªùÁªè", "Âº∫Â∫¶": 0, "‰ΩçÁΩÆ": "Âè≥‰æß", "ÂéüÂõ†Ê†áÁ≠æ": ["Ê≠£Â∏∏ÁîüÁêÜ", "ËÇæÊ∞îË°∞ÈÄÄ"]}], "ÁóÖÂõ†ÂàÜÊûê": {"ÂæÆÂæ™ÁéØ": 15, "‰ΩìË¥®": 16, "ÊØíÁ¥†": 14, "‰π†ÊÉØ": 10, "Ëê•ÂÖª": 9, "ÂÜÖÂàÜÊ≥å": 5, "ÂÖçÁñ´Âäõ": 6, "Ê∞îË°Ä": 5}, "ËÑèËÖëÂàÜÊûê": {"ËÇù": 12, "ËÉÉ": 6, "ËÇæ": 5, "ËÑæ": 5, "ÁªºÂêà": 4}, "‰ΩìË¥®ÂàÜÊûê": {"Ë°ÄËôö": 12, "ÂØíÂáâ": 10, "Ê∞îËôö": 11, "Èò≥Ëôö": 4, "Èò¥Ëôö": 5, "Ë°ÄÁòÄ": 3, "Ê∞îÈÉÅ": 0, "ÊπøÁÉ≠": 0, "Áó∞Êπø": 0}, "Ê≥®ÊÑè‰∫ãÈ°π": {"Ë°∞ËÄÅ": 8, "ÂâØ‰ΩúÁî®": 5, "ËÑæ": 4, "ËÉÉ": 4, "ËÇæ": 2, "ÁéØÂ¢É": 3, "ÂèóÂáâ": 2, "ÈÅøÂ≠ïËçØ": 1, "ÁªèÊúü": 1, "ÂºÇÁâ©": 1, "ËøáÈ´ò": 2, "Êõ¥Âπ¥Êúü": 2, "ÊπøÊ∞îÈáç": 1, "Âí≥ÂóΩ": 1, "ÂøÉ": 1}, "Á¶ÅÂøå‰∫ãÈ°π": {"Ê≤πËÖª": 10, "ÈÖí": 10, "ÁîüÂÜ∑": 9, "ËÇ•ËÇâ": 8, "Âà∫ÊøÄ": 8, "ËæõËæ£": 7, "ÁÉü": 7, "ÂÜ∑È•Æ": 5, "ÁîúÈ£ü": 4, "Ëæ£Ê§í": 3, "ËõãÈªÑ": 2, "ÂÜÖËÑè": 2, "Âï§ÈÖí": 2, "Á≥ØÁ±≥": 2}, "ÊÉÖÁª™Áä∂ÊÄÅ": {"ÊÄí": 10, "ÂéãÂäõËøáÂ§ß": 5, "ÊÄù": 4, "ÊäëÈÉÅ": 3, "Á¥ßÂº†": 3, "ÂøÉÊÉÖ‰∏çÂ•Ω": 1, "ÂìÄ": 1, "ÁÑ¶Ëôë": 1, "ÊøÄÂä®": 1, "ÊÅê": 0, "ÊÉÖÂøóÂ§±Ë∞É": 0, "ÊÉä": 0, "Á≤æÁ•û": 0}, "ÂÅ•Â∫∑Ë∂ãÂäø": {"Â§ñ‰º§": 6, "ÈÅó‰º†": 7, "È´òË°ÄÂéã": 5, "Â§±Áú†": 3, "Á≥ñÂ∞øÁóÖ": 4, "ÈùíÂÖâÁúº": 3, "ÊÑüÂÜí": 2, "È¢àÊ§éÁóÖ": 2, "ËÇøÁò§": 2, "Áî≤‰∫¢": 2, "Ê∂àÂåñ‰∏çËâØ": 2, "Ëê•ÂÖª‰∏çËâØ": 2}, "ÁîüÊ¥ª‰π†ÊÉØ": {"ÁÜ¨Â§ú": 7, "Áî®ÁúºËøáÂ∫¶": 6, "ËøáÂä≥": 4, "ËøêÂä®ËøáÂ∞ë": 4, "Ë¥™Âáâ": 4, "ËæêÂ∞Ñ": 3, "‰ΩúÊÅØ‰∏çËßÑÂæã": 1, "È•ÆÊ∞¥ËøáÂ∞ë": 1, "‰πÖÂùê": 1}, "ÁüøÁâ©Ë¥®Áº∫‰πè": {"Èíô": 12, "Èîå": 12, "Á°í": 7, "ÈïÅ": 5, "Èì¨": 4, "Èî∞": 3, "ÈìÅ": 3, "Á£∑": 3}, "Áª¥ÁîüÁ¥†Áº∫‰πè": {"A": 12, "C": 11, "E": 10, "B1": 7, "B12": 6, "B2": 5, "B7": 4, "B6": 4, "F": 4, "B3": 3, "B5": 3, "P": 3, "B1_": 2, "D_": 2, "B9": 2, "M": 2}}}];
        
        let currentAssessment = null;
        let selectedSymptoms = new Set();
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ÁÆ°ÁêÜÂêéÂè∞ÂàùÂßãÂåñÂÆåÊàê');
            renderAssessments();
            updateStats();
        });
        
        function updateStats() {
            let totalSymptoms = 0;
            ASSESSMENTS_DATA.forEach(item => {
                const data = item.data;
                if (data.selectedSymptoms) {
                    totalSymptoms += data.selectedSymptoms.length;
                }
            });
            document.getElementById('total-symptoms-count').textContent = totalSymptoms;
            
            const today = new Date().toISOString().split('T')[0];
            const todayCount = ASSESSMENTS_DATA.filter(item => {
                const data = item.data;
                return data.timestamp && data.timestamp.startsWith(today);
            }).length;
            document.getElementById('today-assessments').textContent = todayCount;
        }
        
        function renderAssessments() {
            const container = document.getElementById('assessments-grid');
            
            if (ASSESSMENTS_DATA.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="icon">üìã</div>
                        <div class="message">ÊöÇÊó†ËØÑ‰º∞ËÆ∞ÂΩï</div>
                        <div class="hint">ËØ∑ÂØºÂÖ•ÂÆ¢Êà∑ËØÑ‰º∞Êï∞ÊçÆ</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = ASSESSMENTS_DATA.map((item, index) => {
                const data = item.data;
                const customerInfo = data.customerInfo || {};
                const selectedSymptoms = data.selectedSymptoms || [];
                const assessmentResults = data.assessmentResults || {};
                
                const name = customerInfo.name || 'Êú™Áü•';
                const date = data.timestamp ? new Date(data.timestamp).toLocaleDateString('zh-CN') : 'Êú™Áü•';
                const symptomCount = selectedSymptoms.length;
                const mildCount = assessmentResults.summary ? assessmentResults.summary.mild : 0;
                const moderateCount = assessmentResults.summary ? assessmentResults.summary.moderate : 0;
                const severeCount = assessmentResults.summary ? assessmentResults.summary.severe : 0;
                
                return `
                    <div class="assessment-card" onclick="showDetail(${index})">
                        <div class="card-header">
                            <div class="customer-name">${name}</div>
                            <div class="card-date">${date}</div>
                        </div>
                        <div style="font-size: 12px; color: #999; margin-bottom: 15px;">
                            Êñá‰ª∂Âêç: ${item.filename}
                        </div>
                        <div class="card-stats">
                            <div class="card-stat">
                                <div class="label">ÁóáÁä∂Êï∞</div>
                                <div class="value">${symptomCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">ËΩªÂ∫¶</div>
                                <div class="value">${mildCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">‰∏≠Â∫¶</div>
                                <div class="value">${moderateCount}</div>
                            </div>
                            <div class="card-stat">
                                <div class="label">ÈáçÂ∫¶</div>
                                <div class="value">${severeCount}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function showDetail(index) {
            const item = ASSESSMENTS_DATA[index];
            currentAssessment = item;
            selectedSymptoms = new Set();
            
            const selectedSymptomsList = item.data.selectedSymptoms || [];
            selectedSymptomsList.forEach(s => {
                selectedSymptoms.add(s.id);
            });
            
            const customerInfo = item.data.customerInfo || {};
            document.getElementById('detail-title').textContent = 
                customerInfo.name ? `${customerInfo.name} ÁöÑÂÅ•Â∫∑ËØÑ‰º∞ËØ¶ÊÉÖ` : 'ÂÆ¢Êà∑ËØ¶ÊÉÖ';
            
            renderCustomerInfo(customerInfo);
            renderAssessmentStats(item.data);
            renderSymptomsList(item.data);
            
            document.getElementById('detail-panel').classList.add('show');
            document.getElementById('detail-panel').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        function renderCustomerInfo(customerInfo) {
            const container = document.getElementById('customer-info');
            const info = [
                { label: 'ÂßìÂêç', value: customerInfo.name || 'Êú™Â°´ÂÜô' },
                { label: 'Âπ¥ÈæÑ', value: customerInfo.age ? customerInfo.age + 'Â≤Å' : 'Êú™Â°´ÂÜô' },
                { label: 'ÊÄßÂà´', value: customerInfo.gender || 'Êú™Â°´ÂÜô' },
                { label: 'ÊâãÊú∫', value: customerInfo.mobile || 'Êú™Â°´ÂÜô' },
                { label: 'Ë∫´È´ò', value: customerInfo.height ? customerInfo.height + 'cm' : 'Êú™Â°´ÂÜô' },
                { label: '‰ΩìÈáç', value: customerInfo.weight ? customerInfo.weight + 'kg' : 'Êú™Â°´ÂÜô' },
                { label: 'ËÖ∞Âõ¥', value: customerInfo.waistline ? customerInfo.waistline + 'cm' : 'Êú™Â°´ÂÜô' },
                { label: 'Ë°ÄÁ≥ñ', value: customerInfo.bloodSugar ? customerInfo.bloodSugar + 'mmol/L' : 'Êú™Â°´ÂÜô' },
                { label: 'Êî∂Áº©Âéã', value: customerInfo.systolic ? customerInfo.systolic + 'mmHg' : 'Êú™Â°´ÂÜô' },
                { label: 'ËàíÂº†Âéã', value: customerInfo.diastolic ? customerInfo.diastolic + 'mmHg' : 'Êú™Â°´ÂÜô' },
                { label: 'Âú∞ÂùÄ', value: customerInfo.address || 'Êú™Â°´ÂÜô' },
                { label: 'Â§áÊ≥®', value: customerInfo.notes || 'Êó†' },
            ];
            
            container.innerHTML = info.map(item => `
                <div class="info-item">
                    <label>${item.label}</label>
                    <div class="value">${item.value}</div>
                </div>
            `).join('');
        }
        
        function renderAssessmentStats(data) {
            const results = data.assessmentResults || {};
            const summary = results.summary || { total: 0, mild: 0, moderate: 0, severe: 0 };
            
            const container = document.getElementById('assessment-stats');
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${summary.total}</div>
                    <div class="stat-label">ÁóáÁä∂ÊÄªÊï∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.mild}</div>
                    <div class="stat-label">ËΩªÂ∫¶ÁóáÁä∂</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.moderate}</div>
                    <div class="stat-label">‰∏≠Â∫¶ÁóáÁä∂</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${summary.severe}</div>
                    <div class="stat-label">ÈáçÂ∫¶ÁóáÁä∂</div>
                </div>
            `;
        }
        
        function renderSymptomsList(data) {
            const selectedSymptomsList = data.selectedSymptoms || [];
            const container = document.getElementById('symptoms-list');
            
            // ÂÖàÂÆö‰πâÊÄßÂà´ÂíåÂ¶áÁßëÁóáÁä∂
            const gender = data.customer_info?.gender || '';
            const gynecologicalSymptoms = [270];
            
            // Ê†πÊçÆÊÄßÂà´ËøáÊª§ÁóáÁä∂
            const filteredSymptoms = selectedSymptomsList.filter(symptom => {
                if (gender === 'Áî∑' && gynecologicalSymptoms.includes(symptom.id)) {
                    return false;
                }
                return true;
            });
            
            // Êõ¥Êñ∞ËÆ°Êï∞
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            document.getElementById('total-symptoms-in-report').textContent = filteredSymptoms.length;
            
            if (filteredSymptoms.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="icon">üìã</div>
                        <div class="message">ÊöÇÊó†ÁóáÁä∂Êï∞ÊçÆ</div>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredSymptoms.map(symptom => {
                const isSelected = selectedSymptoms.has(symptom.id);
                return `
                    <div class="symptom-item ${isSelected ? 'selected' : ''}" 
                         onclick="toggleSymptom(${symptom.id})">
                        <div class="symptom-name">${symptom.name}</div>
                        <div class="symptom-check"></div>
                    </div>
                `;
            }).join('');
        }
        
        function toggleSymptom(symptomId) {
            if (selectedSymptoms.has(symptomId)) {
                selectedSymptoms.delete(symptomId);
            } else {
                selectedSymptoms.add(symptomId);
            }
            
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            renderSymptomsList(currentAssessment.data);
        }
        
        function selectAllSymptoms() {
            const selectedSymptomsList = currentAssessment.data.selectedSymptoms || [];
            selectedSymptomsList.forEach(s => {
                selectedSymptoms.add(s.id);
            });
            document.getElementById('selected-symptoms-count').textContent = selectedSymptoms.size;
            renderSymptomsList(currentAssessment.data);
        }
        
        function deselectAllSymptoms() {
            selectedSymptoms.clear();
            document.getElementById('selected-symptoms-count').textContent = 0;
            renderSymptomsList(currentAssessment.data);
        }
        
        function closeDetail() {
            document.getElementById('detail-panel').classList.remove('show');
            currentAssessment = null;
            selectedSymptoms.clear();
        }
        
        function generatePDFReport() {
            if (!currentAssessment) {
                alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∏™ÂÆ¢Êà∑ËÆ∞ÂΩï');
                return;
            }
            
            if (selectedSymptoms.size === 0) {
                alert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™ÁóáÁä∂');
                return;
            }
            
            showLoading('Ê≠£Âú®ÁîüÊàêPDFÊä•Âëä...');
            
            setTimeout(() => {
                const data = currentAssessment.data;
                const customerInfo = data.customerInfo || {};
                const assessmentResults = data.assessmentResults || {};
                
                const selectedSymptomsList = (data.selectedSymptoms || []).filter(
                    s => selectedSymptoms.has(s.id)
                );
                
                const reportHTML = generateReportHTML(customerInfo, assessmentResults, selectedSymptomsList);
                
                hideLoading();
                
                const reportWindow = window.open();
                reportWindow.document.write(reportHTML);
                reportWindow.document.close();
                
                alert('PDFÊä•ÂëäÂ∑≤ÁîüÊàêÔºåËØ∑‰ΩøÁî®ÊµèËßàÂô®ÊâìÂç∞ÂäüËÉΩÔºàCtrl+PÔºâ‰øùÂ≠ò‰∏∫PDF');
            }, 1000);
        }
        
        function generateReportHTML(customerInfo, assessmentResults, selectedSymptomsList) {
            const summary = assessmentResults.summary || {};
            const dimensions = assessmentResults.dimensions || {};
            const organs = assessmentResults.organs || {};
            const recommendations = assessmentResults.recommendations || [];
            
            return `
        <!DOCTYPE html>
        <html lang="zh-CN">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>ÂÖÉÁÇÅÊ∫êÊµÅ ¬∑ ÂÅ•Â∫∑ËØÑ‰º∞Êä•Âëä</title>
            <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body { font-family: 'Noto Serif SC', serif; line-height: 1.8; color: #2C2C2C; margin: 0; padding: 40px; background: #FAFAFA; }
                .container { max-width: 1000px; margin: 0 auto; background: white; padding: 50px; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
                .header { text-align: center; margin-bottom: 50px; border-bottom: 3px solid #C8A655; padding-bottom: 30px; }
                .header h1 { font-size: 32px; color: #C8A655; margin-bottom: 15px; letter-spacing: 6px; }
                .vip-badge { background: #C8A655; color: white; padding: 8px 24px; border-radius: 25px; font-size: 14px; display: inline-block; margin-bottom: 20px; letter-spacing: 2px; }
                .section { margin-bottom: 35px; }
                .section-title { font-size: 22px; font-weight: 700; color: #2C2C2C; margin-bottom: 20px; position: relative; padding-bottom: 10px; border-bottom: 2px solid #E8E8E8; }
                .section-title::after { content: ''; width: 60px; height: 3px; background: #C8A655; position: absolute; bottom: -2px; left: 0; }
                .info-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                .info-table th, .info-table td { padding: 12px 15px; border-bottom: 1px solid #E8E8E8; text-align: left; font-size: 14px; }
                .info-table th { background: #F8F6F2; color: #2C2C2C; font-weight: 600; width: 30%; }
                .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 20px 0; }
                .stat-card { background: #F8F6F2; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
                .stat-card h4 { font-size: 14px; color: #2C2C2C; margin-bottom: 10px; font-weight: 600; }
                .stat-value { font-size: 32px; font-weight: 700; color: #C8A655; }
                .recommendations { background: #E8F5E9; border-left: 4px solid #4CAF50; padding: 20px; margin: 20px 0; border-radius: 5px; }
                .recommendations h4 { margin-top: 0; color: #2E7D32; font-size: 16px; margin-bottom: 12px; }
                .recommendations ul { margin: 0; padding-left: 20px; }
                .recommendations li { margin-bottom: 6px; color: #333; font-size: 14px; }
                .footer { text-align: center; margin-top: 50px; padding-top: 30px; border-top: 1px solid #E8E8E8; color: #999; font-size: 12px; }
                @media print { body { padding: 0; background: white; } .container { box-shadow: none; padding: 30px; } }
            </style>
        </head>
        <body>
            <div class="container">
                <div class="header">
                    <div class="vip-badge">VIP ‰∏ìÂ±ûÊä•Âëä</div>
                    <h1>ÂÖÉÁÇÅÊ∫êÊµÅ</h1>
                    <h3>ÂÅ•Â∫∑ËØÑ‰º∞Êä•Âëä</h3>
                    <p style="color: #999; margin-top: 15px; letter-spacing: 1px; font-size: 13px;">${new Date().toLocaleString('zh-CN')}</p>
                </div>
                
                <div class="section">
                    <div class="section-title">‰∏Ä„ÄÅ‰∏™‰∫∫Âü∫Êú¨‰ø°ÊÅØ</div>
                    <table class="info-table">
                        <tr><th>ÂßìÂêç</th><td>${customerInfo.name || 'Êú™Â°´ÂÜô'}</td><th>Âπ¥ÈæÑ</th><td>${customerInfo.age || 'Êú™Â°´ÂÜô'} Â≤Å</td></tr>
                        <tr><th>ÊÄßÂà´</th><td>${customerInfo.gender || 'Êú™Â°´ÂÜô'}</td><th>ËÅîÁ≥ªÊñπÂºè</th><td>${customerInfo.mobile || 'Êú™Â°´ÂÜô'}</td></tr>
                        <tr><th>Ë∫´È´ò</th><td>${customerInfo.height ? customerInfo.height + 'cm' : 'Êú™Â°´ÂÜô'}</td><th>‰ΩìÈáç</th><td>${customerInfo.weight ? customerInfo.weight + 'kg' : 'Êú™Â°´ÂÜô'}</td></tr>
                        <tr><th>Êî∂Áº©Âéã</th><td>${customerInfo.systolic || 'Êú™Â°´ÂÜô'} mmHg</td><th>ËàíÂº†Âéã</th><td>${customerInfo.diastolic || 'Êú™Â°´ÂÜô'} mmHg</td></tr>
                        <tr><th>Ë°ÄÁ≥ñ</th><td>${customerInfo.bloodSugar || 'Êú™Â°´ÂÜô'} mmol/L</td><th>ËÖ∞Âõ¥</th><td>${customerInfo.waistline ? customerInfo.waistline + 'cm' : 'Êú™Â°´ÂÜô'}</td></tr>
                        <tr><th>Âú∞ÂùÄ</th><td colspan="3">${customerInfo.address || 'Êú™Â°´ÂÜô'}</td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">‰∫å„ÄÅÁóáÁä∂ÁªüËÆ°</div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4>ÊÄªÁóáÁä∂Êï∞</h4>
                            <div class="stat-value">${summary.total}</div>
                        </div>
                        <div class="stat-card">
                            <h4>ËΩªÂ∫¶ÁóáÁä∂</h4>
                            <div class="stat-value">${summary.mild}</div>
                        </div>
                        <div class="stat-card">
                            <h4>‰∏≠Â∫¶ÁóáÁä∂</h4>
                            <div class="stat-value">${summary.moderate}</div>
                        </div>
                        <div class="stat-card">
                            <h4>ÈáçÂ∫¶ÁóáÁä∂</h4>
                            <div class="stat-value">${summary.severe}</div>
                        </div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">‰∏â„ÄÅÁª¥Â∫¶ÂæóÂàÜ</div>
                    <table class="info-table">
                        <tr><th>ÊØíÁ¥†</th><td>${dimensions.toxins || 0}%</td><th>Ëê•ÂÖª</th><td>${dimensions.nutrition || 0}%</td></tr>
                        <tr><th>ÂÖçÁñ´Âäõ</th><td>${dimensions.immunity || 0}%</td><th>‰π†ÊÉØ</th><td>${dimensions.habit || 0}%</td></tr>
                        <tr><th>ÂÜÖÂàÜÊ≥å</th><td>${dimensions.endocrine || 0}%</td><th>Âæ™ÁéØ</th><td>${dimensions.circulation || 0}%</td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">Âõõ„ÄÅËÑèËÖëÂÅ•Â∫∑</div>
                    <table class="info-table">
                        <tr><th>ÂøÉ</th><td>${organs.heart || 0}</td><th>ËÇù</th><td>${organs.liver || 0}</td></tr>
                        <tr><th>ËÇ∫</th><td>${organs.lung || 0}</td><th>ËÇæ</th><td>${organs.kidney || 0}</td></tr>
                        <tr><th>ËÑæ</th><td>${organs.spleen || 0}</td><th></th><td></td></tr>
                    </table>
                </div>
                
                <div class="section">
                    <div class="section-title">‰∫î„ÄÅ‰∏™ÊÄßÂåñÂª∫ËÆÆ</div>
                    <div class="recommendations">
                        <h4>ÂÅ•Â∫∑ÊåáÂØº</h4>
                        <ul>
                            ${recommendations.length > 0 ? recommendations.map(rec => `<li>${rec}</li>`).join('') : '<li>‰øùÊåÅËâØÂ•ΩÁöÑÁîüÊ¥ª‰π†ÊÉØÔºåÂÆöÊúü‰ΩìÊ£Ä</li>'}
                        </ul>
                    </div>
                </div>
                
                <div class="footer">
                    <p>¬© 2026 ÂÖÉÁÇÅÊ∫êÊµÅ ¬∑ VIP‰∏ìÂ±ûÂÅ•Â∫∑ËØÑ‰º∞Á≥ªÁªü</p>
                    <p style="margin-top: 8px; color: #ccc;">ÂÅ•Â∫∑Êï∞ÊçÆ‰ªÖ‰æõÂèÇËÄÉÔºåÂ¶ÇÊúâ‰∏çÈÄÇËØ∑ÂèäÊó∂Â∞±Âåª</p>
                </div>
            </div>
        </body>
        </html>
            `;
        }
        
        function importData() {
            alert('ËØ∑ÁÇπÂáª‰∏ãÊñπÊåâÈíÆÈÄâÊã©JSONÊ†ºÂºèÁöÑËØÑ‰º∞Êï∞ÊçÆÊñá‰ª∂„ÄÇ');
        }
        
        function refreshData() {
            showLoading('Ê≠£Âú®Âà∑Êñ∞Êï∞ÊçÆ...');
            setTimeout(() => {
                hideLoading();
                alert('Êï∞ÊçÆÂ∑≤Âà∑Êñ∞');
            }, 500);
        }
        
        function showLoading(text) {
            document.getElementById('loading-text').textContent = text;
            document.getElementById('loading-overlay').classList.add('show');
        }
        
        function hideLoading() {
            document.getElementById('loading-overlay').classList.remove('show');
        }
    
        
        // ========== Â¢ûÂº∫ÂØºÂá∫ÂäüËÉΩ ==========
        
        // ÂØºÂá∫ÊâÄÊúâËØÑ‰º∞Êï∞ÊçÆ‰∏∫Excel/CSVÊ†ºÂºè
        function exportAllToExcel() {
            if (window.allAssessments.length === 0) {
                alert('ÊöÇÊó†ËØÑ‰º∞Êï∞ÊçÆÂèØÂØºÂá∫ÔºÅ');
                return;
            }
            
            // ÊûÑÂª∫CSVÂÜÖÂÆπ
            let csvContent = 'ÁºñÂè∑,ÂßìÂêç,ÁîµËØù,Âπ¥ÈæÑ,ÊÄßÂà´,Ë∫´È´ò,‰ΩìÈáç,ËÖ∞Âõ¥,Êî∂Áº©Âéã,ËàíÂº†Âéã,Ë°ÄÁ≥ñ,ËØÑ‰º∞Êó•Êúü,ÁóáÁä∂ÊÄªÊï∞,ËΩªÂ∫¶,‰∏≠Â∫¶,ÈáçÂ∫¶,ÁóáÁä∂ÂàóË°®\n';
            
            window.allAssessments.forEach((assessment, index) => {
                const basicInfo = assessment.Âü∫Êú¨‰ø°ÊÅØ || assessment;
                const symptoms = assessment.Â∑≤ÈÄâÊã©ÁóáÁä∂ || [];
                
                // ÁªüËÆ°‰∏•ÈáçÁ®ãÂ∫¶
                let mild = 0, moderate = 0, severe = 0;
                symptoms.forEach(s => {
                    if (typeof s === 'object' && s.‰∏•ÈáçÁ®ãÂ∫¶) {
                        if (s.‰∏•ÈáçÁ®ãÂ∫¶ === 'ËΩªÂ∫¶') mild++;
                        else if (s.‰∏•ÈáçÁ®ãÂ∫¶ === '‰∏≠Â∫¶') moderate++;
                        else if (s.‰∏•ÈáçÁ®ãÂ∫¶ === 'ÈáçÂ∫¶') severe++;
                    }
                });
                
                // ÁóáÁä∂ÂàóË°®ÔºàÁî®ÂàÜÂè∑ÂàÜÈöîÔºâ
                const symptomList = symptoms.map(s => typeof s === 'object' ? s.ÁóáÁä∂ : s).join(';');
                
                const row = [
                    index + 1,
                    basicInfo.ÂßìÂêç || 'Êú™Áü•',
                    basicInfo.ÁîµËØù || '',
                    basicInfo.Âπ¥ÈæÑ || '',
                    basicInfo.ÊÄßÂà´ || '',
                    basicInfo.Ë∫´È´ò || '',
                    basicInfo.‰ΩìÈáç || '',
                    basicInfo.ËÖ∞Âõ¥ || '',
                    basicInfo.Êî∂Áº©Âéã || '',
                    basicInfo.ËàíÂº†Âéã || '',
                    basicInfo.Ë°ÄÁ≥ñ || '',
                    assessment.ËØÑ‰º∞Êó•Êúü || '',
                    symptoms.length,
                    mild,
                    moderate,
                    severe,
                    `"${symptomList}"`
                ];
                
                csvContent += row.join(',') + '\n';
            });
            
            // ‰∏ãËΩΩCSVÊñá‰ª∂
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ÂÖÉÁÇÅÊ∫êÊµÅËØÑ‰º∞Êï∞ÊçÆÊ±áÊÄª_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`ÊàêÂäüÂØºÂá∫ ${window.allAssessments.length} Êù°ËØÑ‰º∞Êï∞ÊçÆ‰∏∫Excel/CSVÊ†ºÂºèÔºÅ`);
        }
        
        // ÂØºÂá∫ÊâÄÊúâJSONÊï∞ÊçÆÔºàÊâìÂåÖÂ§á‰ªΩÔºâ
        function exportAllJSON() {
            if (window.allAssessments.length === 0) {
                alert('ÊöÇÊó†ËØÑ‰º∞Êï∞ÊçÆÂèØÂØºÂá∫ÔºÅ');
                return;
            }
            
            // ÂàõÂª∫Â§á‰ªΩÂØπË±°
            const backup = {
                Â§á‰ªΩÊó∂Èó¥: new Date().toLocaleString('zh-CN'),
                Á≥ªÁªüÂêçÁß∞: 'ÂÖÉÁÇÅÊ∫êÊµÅÂÅ•Â∫∑ËØÑ‰º∞Á≥ªÁªü',
                ÁâàÊú¨: 'v1.0',
                Êï∞ÊçÆÁªüËÆ°: {
                    ÊÄªËØÑ‰º∞Êï∞: window.allAssessments.length,
                    ÊÄªÁóáÁä∂Êï∞: window.allAssessments.reduce((sum, a) => sum + (a.Â∑≤ÈÄâÊã©ÁóáÁä∂?.length || 0), 0)
                },
                ËØÑ‰º∞Êï∞ÊçÆ: window.allAssessments
            };
            
            // ‰∏ãËΩΩJSONÊñá‰ª∂
            const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ÂÖÉÁÇÅÊ∫êÊµÅÊï∞ÊçÆÂ§á‰ªΩ_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`ÊàêÂäüÂØºÂá∫Êï∞ÊçÆÂ§á‰ªΩÔºåÂåÖÂê´ ${window.allAssessments.length} Êù°ËØÑ‰º∞ËÆ∞ÂΩïÔºÅ`);
        }
        
        // Â§çÂà∂ËØÑ‰º∞ËØ¶ÊÉÖÂà∞Ââ™Ë¥¥Êùø
        function copyAssessmentDetails(index) {
            const assessment = window.allAssessments[index];
            if (!assessment) {
                alert('ËØÑ‰º∞Êï∞ÊçÆ‰∏çÂ≠òÂú®ÔºÅ');
                return;
            }
            
            const basicInfo = assessment.Âü∫Êú¨‰ø°ÊÅØ || assessment;
            const symptoms = assessment.Â∑≤ÈÄâÊã©ÁóáÁä∂ || [];
            
            const text = `
„ÄêÂÖÉÁÇÅÊ∫êÊµÅÂÅ•Â∫∑ËØÑ‰º∞Êä•Âëä„Äë

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Âü∫Êú¨‰ø°ÊÅØ
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ÂßìÂêçÔºö${basicInfo.ÂßìÂêç || 'Êú™Áü•'}
ÁîµËØùÔºö${basicInfo.ÁîµËØù || 'Êú™Â°´ÂÜô'}
Âπ¥ÈæÑÔºö${basicInfo.Âπ¥ÈæÑ || 'Êú™Â°´ÂÜô'}
ÊÄßÂà´Ôºö${basicInfo.ÊÄßÂà´ || 'Êú™Â°´ÂÜô'}
Ë∫´È´òÔºö${basicInfo.Ë∫´È´ò || 'Êú™Â°´ÂÜô'} cm
‰ΩìÈáçÔºö${basicInfo.‰ΩìÈáç || 'Êú™Â°´ÂÜô'} kg
ËÖ∞Âõ¥Ôºö${basicInfo.ËÖ∞Âõ¥ || 'Êú™Â°´ÂÜô'} cm
Êî∂Áº©ÂéãÔºö${basicInfo.Êî∂Áº©Âéã || 'Êú™Â°´ÂÜô'} mmHg
ËàíÂº†ÂéãÔºö${basicInfo.ËàíÂº†Âéã || 'Êú™Â°´ÂÜô'} mmHg
Ë°ÄÁ≥ñÔºö${basicInfo.Ë°ÄÁ≥ñ || 'Êú™Â°´ÂÜô'} mmol/L
ËØÑ‰º∞Êó•ÊúüÔºö${assessment.ËØÑ‰º∞Êó•Êúü || 'Êú™Áü•'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ÁóáÁä∂ÁªüËÆ°
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ÁóáÁä∂ÊÄªÊï∞Ôºö${symptoms.length} ‰∏™

ÁóáÁä∂ÂàóË°®Ôºö
${symptoms.map((s, i) => `${i+1}. ${typeof s === 'object' ? s.ÁóáÁä∂ : s} (${typeof s === 'object' ? s.‰∏•ÈáçÁ®ãÂ∫¶ || 'Êú™Ê†áËÆ∞' : 'Êú™Ê†áËÆ∞'})`).join('\n')}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
ÁîüÊàêÊó∂Èó¥Ôºö${new Date().toLocaleString('zh-CN')}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
            `.trim();
            
            // Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø
            navigator.clipboard.writeText(text).then(() => {
                alert('ËØÑ‰º∞ËØ¶ÊÉÖÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºÅÂèØ‰ª•Á≤òË¥¥Âà∞ÂæÆ‰ø°„ÄÅWordÁ≠âÂ∫îÁî®„ÄÇ');
            }).catch(err => {
                console.error('Â§çÂà∂Â§±Ë¥•:', err);
                alert('Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®ÈÄâÊã©ÊñáÊú¨Â§çÂà∂„ÄÇ');
            });
        }
        
        // ÂØºÂá∫ÁóáÁä∂Êï∞ÊçÆÂ∫ì‰∏∫ExcelÊ†ºÂºè
        function exportSymptomsDatabase() {
            // ËØªÂèñÁóáÁä∂Êï∞ÊçÆÂ∫ì
            if (!window.symptomsDatabase) {
                alert('ÁóáÁä∂Êï∞ÊçÆÂ∫ìÊú™Âä†ËΩΩÔºåËØ∑Âà∑Êñ∞È°µÈù¢ÈáçËØïÔºÅ');
                return;
            }
            
            // ÊûÑÂª∫CSVÂÜÖÂÆπ
            let csvContent = 'ÁºñÂè∑,ÁóáÁä∂ÂêçÁß∞,È¢úËâ≤Âå∫Âüü,ËÑèËÖë,‰ΩìË¥®,ÊàêÂõ†,Ê≥®ÊÑè‰∫ãÈ°π\n';
            
            window.symptomsDatabase.forEach((symptom, index) => {
                const row = [
                    index + 1,
                    symptom.name || symptom.ÁóáÁä∂ || 'Êú™Áü•',
                    symptom.color || symptom.È¢úËâ≤ || 'Êú™Áü•',
                    symptom.organ || symptom.ËÑèËÖë || 'Êú™Áü•',
                    symptom.constitution || symptom.‰ΩìË¥® || 'Êú™Áü•',
                    (symptom.cause || symptom.ÊàêÂõ† || '').replace(/,/g, 'Ôºõ'),
                    (symptom.note || symptom.Ê≥®ÊÑè‰∫ãÈ°π || '').replace(/,/g, 'Ôºõ')
                ];
                
                csvContent += row.join(',') + '\n';
            });
            
            // ‰∏ãËΩΩCSVÊñá‰ª∂
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ÂÖÉÁÇÅÊ∫êÊµÅÁóáÁä∂Êï∞ÊçÆÂ∫ì_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`ÊàêÂäüÂØºÂá∫ÁóáÁä∂Êï∞ÊçÆÂ∫ìÔºà${window.symptomsDatabase.length}‰∏™ÁóáÁä∂Ôºâ‰∏∫ExcelÊ†ºÂºèÔºÅ`);
        }
        
        // Ëá™ÂÆö‰πâÂØºÂá∫Â≠óÊÆµ
        function customExport() {
            if (window.allAssessments.length === 0) {
                alert('ÊöÇÊó†ËØÑ‰º∞Êï∞ÊçÆÂèØÂØºÂá∫ÔºÅ');
                return;
            }
            
            // ÂàõÂª∫Ëá™ÂÆö‰πâÂØºÂá∫ÂØπËØùÊ°Ü
            const fields = [
                { id: 'name', label: 'ÂßìÂêç', checked: true },
                { id: 'phone', label: 'ÁîµËØù', checked: false },
                { id: 'age', label: 'Âπ¥ÈæÑ', checked: true },
                { id: 'gender', label: 'ÊÄßÂà´', checked: true },
                { id: 'height', label: 'Ë∫´È´ò', checked: false },
                { id: 'weight', label: '‰ΩìÈáç', checked: false },
                { id: 'symptoms', label: 'ÁóáÁä∂ÂàóË°®', checked: true },
                { id: 'date', label: 'ËØÑ‰º∞Êó•Êúü', checked: true }
            ];
            
            let html = `
                <div id="custom-export-modal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:1000;">
                    <div style="background:white;padding:30px;border-radius:15px;max-width:500px;width:90%;">
                        <h3 style="margin-bottom:20px;color:#C8A655;">Ëá™ÂÆö‰πâÂØºÂá∫Â≠óÊÆµ</h3>
                        <div style="margin-bottom:20px;">
                            ${fields.map(f => `
                                <label style="display:block;margin-bottom:10px;cursor:pointer;">
                                    <input type="checkbox" id="field-${f.id}" ${f.checked ? 'checked' : ''}>
                                    ${f.label}
                                </label>
                            `).join('')}
                        </div>
                        <div style="display:flex;gap:10px;">
                            <button onclick="executeCustomExport()" style="flex:1;padding:12px;background:#C8A655;color:white;border:none;border-radius:8px;cursor:pointer;">ÂØºÂá∫</button>
                            <button onclick="document.getElementById('custom-export-modal').remove()" style="flex:1;padding:12px;background:#ddd;color:#333;border:none;border-radius:8px;cursor:pointer;">ÂèñÊ∂à</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', html);
        }
        
        // ÊâßË°åËá™ÂÆö‰πâÂØºÂá∫
        function executeCustomExport() {
            const modal = document.getElementById('custom-export-modal');
            
            // Ëé∑ÂèñÈÄâ‰∏≠ÁöÑÂ≠óÊÆµ
            const selectedFields = [];
            const checkboxes = modal.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach((cb, index) => {
                if (cb.checked) {
                    const fieldId = cb.id.replace('field-', '');
                    const fieldLabels = {
                        'name': 'ÂßìÂêç', 'phone': 'ÁîµËØù', 'age': 'Âπ¥ÈæÑ', 'gender': 'ÊÄßÂà´',
                        'height': 'Ë∫´È´ò', 'weight': '‰ΩìÈáç', 'symptoms': 'ÁóáÁä∂ÂàóË°®', 'date': 'ËØÑ‰º∞Êó•Êúü'
                    };
                    selectedFields.push({ id: fieldId, label: fieldLabels[fieldId] });
                }
            });
            
            if (selectedFields.length === 0) {
                alert('ËØ∑Ëá≥Â∞ëÈÄâÊã©‰∏Ä‰∏™Â≠óÊÆµÔºÅ');
                return;
            }
            
            // ÊûÑÂª∫CSVÂÜÖÂÆπ
            let csvContent = selectedFields.map(f => f.label).join(',') + '\n';
            
            window.allAssessments.forEach(assessment => {
                const basicInfo = assessment.Âü∫Êú¨‰ø°ÊÅØ || assessment;
                const symptoms = assessment.Â∑≤ÈÄâÊã©ÁóáÁä∂ || [];
                const row = selectedFields.map(f => {
                    switch(f.id) {
                        case 'name': return basicInfo.ÂßìÂêç || 'Êú™Áü•';
                        case 'phone': return basicInfo.ÁîµËØù || '';
                        case 'age': return basicInfo.Âπ¥ÈæÑ || '';
                        case 'gender': return basicInfo.ÊÄßÂà´ || '';
                        case 'height': return basicInfo.Ë∫´È´ò || '';
                        case 'weight': return basicInfo.‰ΩìÈáç || '';
                        case 'symptoms': 
                            return `"${symptoms.map(s => typeof s === 'object' ? s.ÁóáÁä∂ : s).join(';')}"`;
                        case 'date': return assessment.ËØÑ‰º∞Êó•Êúü || '';
                        default: return '';
                    }
                });
                csvContent += row.join(',') + '\n';
            });
            
            // ‰∏ãËΩΩCSVÊñá‰ª∂
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ÂÖÉÁÇÅÊ∫êÊµÅËá™ÂÆö‰πâÂØºÂá∫_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            
            modal.remove();
            alert(`ÊàêÂäüÂØºÂá∫ ${selectedFields.length} ‰∏™Â≠óÊÆµÁöÑÊï∞ÊçÆÔºÅ`);
        }
        
        // ========== Â¢ûÂº∫ÂØºÂá∫ÂäüËÉΩÁªìÊùü ==========
        
</script>
</body>
</html>
