# 🎉 元炁源流健康评估系统 - 完整使用指南

## 📋 系统概述

**元炁源流健康评估系统**是一个专业的中医健康管理平台，包含：
- ✅ 健康自检评估功能（299个症状）
- ✅ 评估记录管理
- ✅ 数据统计分析
- ✅ 完整的后台管理系统

---

## 🚀 快速启动（3步完成）

### 第一步：启动后端服务

```bash
# 方式一：启动完整版后端（推荐）
node backend-api-server.js

# 方式二：启动简化版后端（备用方案）
node backend-server-simple.js
```

**启动成功后，您会看到：**
```
元炁源流健康评估系统 - 后端API服务已启动
服务地址: http://localhost:3000
API文档: http://localhost:3000/api/health
```

### 第二步：打开前端页面

**方式一：直接在浏览器中打开**（最简单）
- 双击打开 `health_assessment_ultimate.html` 文件
- 或在浏览器地址栏输入：`file:///完整路径/health_assessment_ultimate.html`

**方式二：通过本地服务器访问**
```bash
# 使用 Python 启动本地服务器（如果已安装 Python）
python -m http.server 8080

# 或使用 Node.js 启动服务器
npx http-server -p 8080

# 然后在浏览器中访问
http://localhost:8080/health_assessment_ultimate.html
```

### 第三步：开始使用健康自检

1. **健康自检页面**：
   - 浏览299个症状卡片
   - 点击症状卡片进行选择
   - 选择严重程度：轻度/中度/重度
   - 查看实时统计信息
   - 填写调理方案或备注
   - 点击"提交评估"按钮

2. **评估记录页面**：
   - 点击顶部导航栏的"评估记录"
   - 查看所有历史评估记录
   - 查看详细的症状分布和统计信息

---

## 📱 前端页面说明

### 1. health_assessment_ultimate.html ⭐ 推荐使用

**功能最完整的版本**，包含：

#### 健康自检模块
- ✅ **299个症状选择卡片** - 完整覆盖中医症状体系
- ✅ **三级严重程度** - 轻度/中度/重度，每个症状可单独设置
- ✅ **实时统计面板** - 动态显示已选症状数量和分布
- ✅ **智能筛选功能**：
  - 显示全部（299个症状）
  - 仅显示已选
  - 仅显示未选
- ✅ **调理方案输入** - 可记录调理方案和额外备注
- ✅ **一键清空** - 方便重新开始评估

#### 评估记录模块
- ✅ **完整历史记录** - 显示所有提交的评估
- ✅ **详细数据展示**：
  - 姓名、评估编号
  - 症状总数
  - 轻度/中度/重度分布统计
  - 提交时间戳
- ✅ **数据统计** - 总评估数、今日评估数
- ✅ **本地存储** - 数据保存在浏览器本地，无需联网

#### 用户体验优化
- ✅ **响应式设计** - 完美适配手机、平板、电脑
- ✅ **优雅UI设计** - 金色+黑色主题，符合"元炁源流"品牌
- ✅ **流畅动画效果** - 页面切换、卡片选择都有平滑过渡
- ✅ **加载提示** - 操作时显示友好提示
- ✅ **通知提醒** - 成功/错误消息自动弹出

---

## 🛠️ 后端API说明

### API 基础信息
- **服务地址**：`http://localhost:3000`
- **数据格式**：JSON
- **编码**：UTF-8

### 主要API端点

#### 1. 健康检查
```bash
GET http://localhost:3000/api/health
```
**响应示例：**
```json
{
  "service": "health-assessment-api",
  "status": "running",
  "database": "connected",
  "timestamp": "2026-01-28T08:00:00.000Z"
}
```

#### 2. 用户登录
```bash
POST http://localhost:3000/api/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

**响应示例：**
```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "admin",
      "real_name": "系统管理员",
      "role": "admin"
    }
  }
}
```

#### 3. 获取评估记录
```bash
GET http://localhost:3000/api/assessments
```

#### 4. 创建新评估
```bash
POST http://localhost:3000/api/assessments
Content-Type: application/json

{
  "real_name": "张三",
  "age": 35,
  "gender": "男",
  "symptoms": [
    {
      "name": "头疼",
      "intensity": 2,
      "severity_level": "中度"
    },
    {
      "name": "眼干涩",
      "intensity": 1,
      "severity_level": "轻度"
    }
  ],
  "notes": "建议注意休息，多喝水"
}
```

#### 5. 获取症状列表
```bash
GET http://localhost:3000/api/symptoms
```

**响应示例：**
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "total": 299,
    "list": [
      {
        "name": "头疼",
        "category": "头部症状"
      },
      ...
    ]
  }
}
```

---

## 🗄️ 数据库配置

### 数据库连接信息（已配置在 .env 文件）

```env
DB_HOST=sjc1.clusters.zeabur.com
DB_PORT=27983
DB_USER=root
DB_PASSWORD=9ODHR03Mp6hw8iYPq1en4QgrU275tEzc
DB_NAME=zeabur
```

### 默认账号

**管理员账号：**
- 用户名：`admin`
- 密码：`admin123`

**调理师账号：**
- 用户名：`practitioner1`
- 密码：`admin123`

---

## 📊 数据文件说明

### 1. symptoms_299_complete.json
- **说明**：包含完整的299个症状数据
- **结构**：每个症状包含名称、分类、描述等信息
- **用途**：前端页面加载症状数据

### 2. 示例评估数据文件
- `sample_assessment_data.json` - 示例评估数据
- `first_assessment_20251213.json` - 第一条评估记录
- `second_assessment_20260113.json` - 第二条评估记录

---

## 🎯 使用场景

### 场景一：个人健康自检
1. 打开 `health_assessment_ultimate.html`
2. 在"健康自检"页面选择症状
3. 选择每个症状的严重程度
4. 填写调理方案或备注
5. 提交评估
6. 在"评估记录"页面查看历史数据

### 场景二：调理师查看客户评估
1. 使用调理师账号登录后台
2. 查看客户的评估记录
3. 分析症状分布和趋势
4. 生成调理方案

### 场景三：管理员管理数据
1. 使用管理员账号登录后台
2. 管理用户账号
3. 查看所有评估记录
4. 导出数据报表

---

## ⚠️ 常见问题

### 1. 后端服务无法启动
**症状**：提示端口已被占用
**解决方法**：
```bash
# 查找占用端口的进程
lsof -i :3000

# 或
netstat -an | grep 3000

# 停止占用端口的进程
kill -9 <进程ID>

# 重新启动后端
node backend-api-server.js
```

### 2. 前端页面无法加载数据
**症状**：症状列表不显示或一直显示"加载中"
**可能原因**：
- `symptoms_299_complete.json` 文件不在同一目录
- 浏览器安全策略限制（某些浏览器禁止直接读取本地 JSON 文件）

**解决方法**：
- 确保所有文件在同一目录
- 使用本地服务器访问（参考"第二步：打开前端页面"的方式二）

### 3. 数据库连接失败
**症状**：启动后端时报错"数据库连接失败"
**解决方法**：
- 检查 `.env` 文件配置是否正确
- 确认数据库服务是否正常运行
- 检查网络连接

### 4. 提交评估后看不到记录
**可能原因**：
- 使用的是简化版前端，数据只保存在本地浏览器
- 后端服务未正常启动

**解决方法**：
- 检查后端服务是否运行
- 检查浏览器控制台是否有错误

---

## 🔧 高级功能

### 1. 自定义主题

如需修改颜色主题，编辑 `health_assessment_ultimate.html` 中的 CSS 变量：

```css
:root {
    --primary-gold: #C8A655;  /* 主色调 */
    --primary-dark: #1A1A1A;  /* 深色调 */
    --primary-light: #F8F6F2;  /* 浅色调 */
}
```

### 2. 修改症状数据

编辑 `symptoms_299_complete.json` 文件，可以：
- 添加新症状
- 修改症状名称
- 调整症状分类

### 3. 导出评估数据

在浏览器控制台执行：
```javascript
// 导出所有评估数据
const assessments = JSON.parse(localStorage.getItem('yuanqi_assessments'));
console.log(assessments);

// 下载为 JSON 文件
const dataStr = JSON.stringify(assessments, null, 2);
const dataBlob = new Blob([dataStr], {type: 'application/json'});
const url = URL.createObjectURL(dataBlob);
const link = document.createElement('a');
link.href = url;
link.download = 'assessments_backup.json';
link.click();
```

---

## 📞 技术支持

如遇到问题，请检查：
1. 后端服务是否正常启动
2. 浏览器控制台是否有错误信息
3. 网络连接是否正常
4. 数据库连接配置是否正确

---

## 🎉 开始使用

现在您已经了解了系统的完整使用方法！

**推荐开始方式：**
1. 启动后端服务：`node backend-api-server.js`
2. 打开前端页面：`health_assessment_ultimate.html`
3. 开始健康自检，体验完整的评估流程

祝您使用愉快！🚀
