# 极简版配置流程

## 🚀 5分钟快速配置指南

### 第一步：测试MySQL连接

1. 打开终端（Windows: 命令提示符/PowerShell, Mac/Linux: Terminal）

2. 复制以下命令粘贴到终端中并按回车：
```bash
mysqlsh --sql --host=sjc1.clusters.zeabur.com --port=27983 --user=root --password=9ODHR03Mp6hw8iYPq1en4QgrU275tEzc --schema=zeabur
```

3. 如果连接成功，你会看到 `zeabur >` 提示符

4. 输入以下命令验证数据库：
```sql
SHOW TABLES;
```
5. 如果返回空列表（还没有创建表），这是正常的

6. 退出：
```sql
\quit
```

---

### 第二步：创建数据库架构

1. 用文本编辑器打开 `database_schema.sql` 文件
2. 复制文件中所有内容
3. 回到终端，再次运行连接命令：
```bash
mysqlsh --sql --host=sjc1.clusters.zeabur.com --port=27983 --user=root --password=9ODHR03Mp6hw8iYPq1en4QgrU275tEzc --schema=zeabur
```
4. 粘贴你复制的 `database_schema.sql` 内容到终端
5. 按回车执行
6. 输入 `\quit` 退出

---

### 第三步：配置后端服务

#### 方法A：本地测试

1. 在项目根目录创建 `.env` 文件，内容为：
```env
PORT=3000
DB_HOST=sjc1.clusters.zeabur.com
DB_PORT=27983
DB_USER=root
DB_PASSWORD=9ODHR03Mp6hw8iYPq1en4QgrU275tEzc
DB_NAME=zeabur
JWT_SECRET=your_very_secure_secret_key_change_this
JWT_EXPIRES_IN=7d
```

2. 安装依赖：
```bash
npm install
```

3. 启动后端服务：
```bash
npm start
```

4. 打开浏览器访问 `http://localhost:3000/`，应看到 "API服务运行中"

#### 方法B：部署到Zeabur

1. 登录Zeabur官网
2. 创建新项目
3. 导入你的GitHub后端仓库
4. 添加环境变量：
```
PORT=3000
DB_HOST=sjc1.clusters.zeabur.com
DB_PORT=27983
DB_USER=root
DB_PASSWORD=9ODHR03Mp6hw8iYPq1en4QgrU275tEzc
DB_NAME=zeabur
JWT_SECRET=your_very_secure_secret_key_change_this
JWT_EXPIRES_IN=7d
```
5. 点击 "Deploy"
6. 部署完成后会得到一个免费域名

---

### 第四步：初始化数据

1. 创建一个 `import_data.js` 文件：
```javascript
const fs = require('fs');
const mysql = require('mysql2');

const connection = mysql.createConnection({
  host: 'sjc1.clusters.zeabur.com',
  user: 'root',
  password: '9ODHR03Mp6hw8iYPq1en4QgrU275tEzc',
  database: 'zeabur',
  port: 27983
});

connection.connect();

// 导入症状库
const symptoms = JSON.parse(fs.readFileSync('symptoms_299_complete.json', 'utf8'));

connection.query('TRUNCATE TABLE symptom_library', (err) => {
  if (err) console.error(err);
  
  symptoms.symptoms.forEach(symptom => {
    connection.query(
      'INSERT INTO symptom_library (name, organ, description) VALUES (?, ?, ?)',
      [symptom.name, symptom.organ, symptom.description],
      (err, results) => {
        if (err) console.error('导入失败:', symptom.name, err);
      }
    );
  });
});

// 创建默认管理员
const bcrypt = require('bcryptjs');
const hashedPassword = bcrypt.hashSync('admin123', 10);

connection.query(
  'INSERT INTO users (username, password, real_name, role) VALUES (?, ?, ?, ?)',
  ['admin', hashedPassword, '系统管理员', 'admin'],
  (err, results) => {
    if (err) console.error('创建管理员失败', err);
    else console.log('默认管理员创建成功');
  }
);

connection.end();
```

2. 执行脚本：
```bash
node import_data.js
```

---

### 第五步：部署前端

1. 在Zeabur创建新的静态网站服务
2. 上传前端文件
3. 替换前端代码中的API地址为你的后端地址
4. 部署完成

---

## 🧪 最终验证

1. 访问前端页面：https://your-frontend.zeabur.app/health_assessment_final_fixed.html
2. 填写评估表单
3. 点击 "提交评估"
4. 如果成功，你会看到评估结果页面
5. 登录管理后台：https://your-frontend.zeabur.app/health_assessment_backend_complete.html
6. 使用默认账户 `admin/admin123` 登录
7. 查看提交的评估记录

---

## 🚩 常见问题解决

### 问题1：MySQL连接失败
**检查：**
- 确保你输入的连接命令正确
- 网络连接正常
- MySQL服务正在运行

### 问题2：后端无法连接MySQL
**检查：**
- .env文件中的数据库参数正确
- 防火墙没有阻止连接
- MySQL主机允许外部访问

### 问题3：前端无法连接后端
**检查：**
- 后端服务正在运行
- 前端配置文件中的API地址正确
- 跨域设置正确

### 问题4：页面显示异常
**检查：**
- 浏览器控制台是否有错误
- HTML文件中的资源路径正确
- CSS和JavaScript文件加载成功

---

## 📞 需要帮助？

如果遇到问题，请告诉我你执行到哪一步和具体的错误信息。